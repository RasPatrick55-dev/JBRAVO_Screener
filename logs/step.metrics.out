[2026-01-09T03:18:04.476910+00:00] START metrics
[2026-01-08 21:18:05,222] [INFO]: Metrics script started
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:59: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  start_time = datetime.utcnow()
[2026-01-08 21:18:05,223] [INFO]: Starting metrics calculation
[2026-01-08 21:18:05,284] [INFO]: Screener Metrics Summary: total_candidates=1, avg_score=1.00
[2026-01-08 21:18:05,284] [INFO]: Top 15 Screener Symbols: VSCO
[2026-01-08 21:18:05,294] [INFO]: Successfully updated C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\top_candidates.csv with 1 records
[2026-01-08 21:18:05,297] [INFO]: Top Candidates: symbol  score  win_rate   net_pnl
  VSCO    1.0 55.729167 7325.7959
[2026-01-08 21:18:05,302] [INFO]: Calculated Metrics: Trades=576, Net PnL=7325.80, Win Rate=55.73%, Expectancy=12.72, Profit Factor=1.4188550006537486, Max Drawdown=-1242.62, Sharpe=5.91, Sortino=11.99
[2026-01-08 21:18:05,306] [INFO]: Exit reason breakdown saved to C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\exit_reason_summary.csv
[2026-01-08 21:18:05,312] [INFO]: Metrics summary CSV successfully updated: C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\metrics_summary.csv
[2026-01-08 21:18:05,317] [INFO]: Metrics calculation complete
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:550: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  end_time = datetime.utcnow()
[2026-01-08 21:18:05,317] [INFO]: Script finished in 0:00:00.094208
[2026-01-09T03:18:05.389504+00:00] END metrics rc=0 secs=0.9
[2026-01-18T03:33:53.522646+00:00] START metrics
[2026-01-17 21:33:54,274] [INFO]: Metrics script started
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:56: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  start_time = datetime.utcnow()
[2026-01-17 21:33:54,276] [INFO]: Starting metrics calculation
Traceback (most recent call last):
  File "C:\Users\RasPa\JBravoGit\JBRAVO_Screener\venv\Lib\site-packages\pandas\core\ops\array_ops.py", line 218, in _na_arithmetic_op
    result = func(left, right)
  File "C:\Users\RasPa\JBravoGit\JBRAVO_Screener\venv\Lib\site-packages\pandas\core\computation\expressions.py", line 242, in evaluate
    return _evaluate(op, op_str, a, b)  # type: ignore[misc]
  File "C:\Users\RasPa\JBravoGit\JBRAVO_Screener\venv\Lib\site-packages\pandas\core\computation\expressions.py", line 73, in _evaluate_standard
    return op(a, b)
TypeError: unsupported operand type(s) for *: 'decimal.Decimal' and 'float'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py", line 505, in <module>
    exit_code = main()
  File "C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py", line 410, in main
    ranked_df = rank_candidates(results_df)
  File "C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py", line 339, in rank_candidates
    df['win_rate_norm'] * weights['win_rate'] +
    ~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~
  File "C:\Users\RasPa\JBravoGit\JBRAVO_Screener\venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
  File "C:\Users\RasPa\JBravoGit\JBRAVO_Screener\venv\Lib\site-packages\pandas\core\arraylike.py", line 202, in __mul__
    return self._arith_method(other, operator.mul)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\RasPa\JBravoGit\JBRAVO_Screener\venv\Lib\site-packages\pandas\core\series.py", line 6146, in _arith_method
    return base.IndexOpsMixin._arith_method(self, other, op)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\RasPa\JBravoGit\JBRAVO_Screener\venv\Lib\site-packages\pandas\core\base.py", line 1391, in _arith_method
    result = ops.arithmetic_op(lvalues, rvalues, op)
  File "C:\Users\RasPa\JBravoGit\JBRAVO_Screener\venv\Lib\site-packages\pandas\core\ops\array_ops.py", line 283, in arithmetic_op
    res_values = _na_arithmetic_op(left, right, op)  # type: ignore[arg-type]
  File "C:\Users\RasPa\JBravoGit\JBRAVO_Screener\venv\Lib\site-packages\pandas\core\ops\array_ops.py", line 227, in _na_arithmetic_op
    result = _masked_arith_op(left, right, op)
  File "C:\Users\RasPa\JBravoGit\JBRAVO_Screener\venv\Lib\site-packages\pandas\core\ops\array_ops.py", line 182, in _masked_arith_op
    result[mask] = op(xrav[mask], y)
                   ~~^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for *: 'decimal.Decimal' and 'float'
[2026-01-18T03:33:59.207969+00:00] END metrics rc=1 secs=5.7
[2026-01-18T03:42:36.198929+00:00] START metrics
[2026-01-17 21:42:36,822] [INFO]: Metrics script started
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:56: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  start_time = datetime.utcnow()
[2026-01-17 21:42:36,822] [INFO]: Starting metrics calculation
Traceback (most recent call last):
  File "C:\Users\RasPa\JBravoGit\JBRAVO_Screener\venv\Lib\site-packages\pandas\core\ops\array_ops.py", line 218, in _na_arithmetic_op
    result = func(left, right)
  File "C:\Users\RasPa\JBravoGit\JBRAVO_Screener\venv\Lib\site-packages\pandas\core\computation\expressions.py", line 242, in evaluate
    return _evaluate(op, op_str, a, b)  # type: ignore[misc]
  File "C:\Users\RasPa\JBravoGit\JBRAVO_Screener\venv\Lib\site-packages\pandas\core\computation\expressions.py", line 73, in _evaluate_standard
    return op(a, b)
TypeError: unsupported operand type(s) for *: 'decimal.Decimal' and 'float'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py", line 505, in <module>
    exit_code = main()
  File "C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py", line 410, in main
    ranked_df = rank_candidates(results_df)
  File "C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py", line 339, in rank_candidates
    df['win_rate_norm'] * weights['win_rate'] +
    ~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~
  File "C:\Users\RasPa\JBravoGit\JBRAVO_Screener\venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
  File "C:\Users\RasPa\JBravoGit\JBRAVO_Screener\venv\Lib\site-packages\pandas\core\arraylike.py", line 202, in __mul__
    return self._arith_method(other, operator.mul)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\RasPa\JBravoGit\JBRAVO_Screener\venv\Lib\site-packages\pandas\core\series.py", line 6146, in _arith_method
    return base.IndexOpsMixin._arith_method(self, other, op)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\RasPa\JBravoGit\JBRAVO_Screener\venv\Lib\site-packages\pandas\core\base.py", line 1391, in _arith_method
    result = ops.arithmetic_op(lvalues, rvalues, op)
  File "C:\Users\RasPa\JBravoGit\JBRAVO_Screener\venv\Lib\site-packages\pandas\core\ops\array_ops.py", line 283, in arithmetic_op
    res_values = _na_arithmetic_op(left, right, op)  # type: ignore[arg-type]
  File "C:\Users\RasPa\JBravoGit\JBRAVO_Screener\venv\Lib\site-packages\pandas\core\ops\array_ops.py", line 227, in _na_arithmetic_op
    result = _masked_arith_op(left, right, op)
  File "C:\Users\RasPa\JBravoGit\JBRAVO_Screener\venv\Lib\site-packages\pandas\core\ops\array_ops.py", line 182, in _masked_arith_op
    result[mask] = op(xrav[mask], y)
                   ~~^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for *: 'decimal.Decimal' and 'float'
[2026-01-18T03:42:41.551026+00:00] END metrics rc=1 secs=5.4
[2026-01-18T03:58:45.386156+00:00] START metrics
[2026-01-17 21:58:45,982] [INFO]: Metrics script started
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:56: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  start_time = datetime.utcnow()
[2026-01-17 21:58:45,982] [INFO]: Starting metrics calculation
[2026-01-17 21:58:50,679] [INFO]: Screener Metrics Summary: total_candidates=14, avg_score=0.35
[2026-01-17 21:58:50,680] [INFO]: Top 15 Screener Symbols: VSCO, PLUG, LOGI, SRRK, HMY, FN, RGLD, SKY, HBAN, ALK, STLD, MIRM, NVST, NBIS
[2026-01-17 21:58:50,682] [INFO]: Top Candidates: symbol    score  win_rate      net_pnl
  VSCO 0.851209 55.729167  7325.795900
  PLUG 0.826545 66.990291  7100.683629
  LOGI 0.428603 51.612903  1469.455100
  SRRK 0.427654 51.388889   961.050010
   HMY 0.423777 48.085106  1168.466136
    FN 0.348817 47.802198     3.993407
  RGLD 0.303993 43.356643   -88.903321
   SKY 0.279833 41.406250  -226.632571
  HBAN 0.245222 41.216216 -1029.891187
   ALK 0.214686 38.983051 -1109.122829
  STLD 0.196352 38.216561 -1720.513029
  MIRM 0.187992 38.000000 -2247.749833
  NVST 0.173469 35.135135 -1385.900537
  NBIS 0.000000  0.000000     0.000000
[2026-01-17 21:58:50,684] [INFO]: Calculated Metrics: Trades=1, Net PnL=-2.59, Win Rate=0.00%, Expectancy=-2.59, Profit Factor=0.0, Max Drawdown=0.00, Sharpe=0.00, Sortino=0.00
[2026-01-17 21:58:55,384] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
[2026-01-17 21:58:55,384] [INFO]: [INFO] METRICS_DB_OK run_date=2026-01-18 total_trades=1 net_pnl=-2.590005000000019
[2026-01-17 21:58:55,395] [INFO]: Metrics calculation complete
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:533: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  end_time = datetime.utcnow()
[2026-01-17 21:58:55,395] [INFO]: Script finished in 0:00:09.413264
[2026-01-18T03:58:55.464242+00:00] END metrics rc=0 secs=10.1
[2026-01-18T04:34:20.863682+00:00] START metrics
[2026-01-17 22:34:21,476] [INFO]: Metrics script started
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:56: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  start_time = datetime.utcnow()
[2026-01-17 22:34:21,476] [INFO]: Starting metrics calculation
[2026-01-17 22:34:26,236] [INFO]: Screener Metrics Summary: total_candidates=15, avg_score=0.31
[2026-01-17 22:34:26,236] [INFO]: Top 15 Screener Symbols: TNXP, CUBWW, SPRO, JFBR, IPDN, ERNA, FGEN, LGHL, PXLW, ONCO, QVCGA, INAB, CDTX, LYEL, EKSO
[2026-01-17 22:34:26,238] [INFO]: Top Candidates: symbol    score  win_rate  net_pnl
  TNXP 0.902703 57.894737  28.9191
 CUBWW 0.437836 57.142857   0.2628
  SPRO 0.411984 50.000000   0.1050
  JFBR 0.407842 50.000000   1.0300
  IPDN 0.391805 50.000000   0.1672
  ERNA 0.370424 50.000000  -0.3500
  FGEN 0.317834 42.857143  -0.8152
  LGHL 0.286461 37.500000  -0.8540
  PXLW 0.280896 33.333333   0.1100
  ONCO 0.267326 33.333333  -2.9862
 QVCGA 0.215876 28.571429  -0.9800
  INAB 0.182959 25.000000  -0.4250
  CDTX 0.082733 27.027027 -25.0216
  LYEL 0.068507 11.111111  -3.2200
  EKSO 0.005140  0.000000  -0.6150
[2026-01-17 22:34:26,246] [INFO]: Successfully updated C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\top_candidates.csv with 15 records
[2026-01-17 22:34:26,254] [INFO]: Metrics summary CSV successfully updated: C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\metrics_summary.csv
[2026-01-17 22:34:26,254] [INFO]: Calculated Metrics: Trades=1, Net PnL=-2.59, Win Rate=0.00%, Expectancy=-2.59, Profit Factor=0.0, Max Drawdown=0.00, Sharpe=0.00, Sortino=0.00
[2026-01-17 22:34:33,744] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=15
[2026-01-17 22:34:33,744] [INFO]: [INFO] METRICS_DB_TOP_CANDIDATES_UPSERT rows=15 run_date=2026-01-18
[2026-01-17 22:34:36,122] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
[2026-01-17 22:34:36,122] [INFO]: [INFO] METRICS_DB_OK run_date=2026-01-18 total_trades=1 net_pnl=-2.590005000000019
[2026-01-17 22:34:36,126] [INFO]: Metrics calculation complete
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:569: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  end_time = datetime.utcnow()
[2026-01-17 22:34:36,126] [INFO]: Script finished in 0:00:14.649926
[2026-01-18T04:34:36.191716+00:00] END metrics rc=0 secs=15.3
[2026-01-18T04:52:01.143413+00:00] START metrics
[2026-01-17 22:52:01,756] [INFO]: Metrics script started
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:56: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  start_time = datetime.utcnow()
[2026-01-17 22:52:01,756] [INFO]: Starting metrics calculation
[2026-01-17 22:52:06,396] [INFO]: [INFO] METRICS_RUN_DATE_RESOLVED run_date=2026-01-02 source=backtest_results
[2026-01-17 22:52:08,821] [INFO]: Screener Metrics Summary: total_candidates=15, avg_score=0.31
[2026-01-17 22:52:08,822] [INFO]: Top 15 Screener Symbols: TNXP, CUBWW, SPRO, JFBR, IPDN, ERNA, FGEN, LGHL, PXLW, ONCO, QVCGA, INAB, CDTX, LYEL, EKSO
[2026-01-17 22:52:08,824] [INFO]: Top Candidates: symbol    score  win_rate  net_pnl
  TNXP 0.902703 57.894737  28.9191
 CUBWW 0.437836 57.142857   0.2628
  SPRO 0.411984 50.000000   0.1050
  JFBR 0.407842 50.000000   1.0300
  IPDN 0.391805 50.000000   0.1672
  ERNA 0.370424 50.000000  -0.3500
  FGEN 0.317834 42.857143  -0.8152
  LGHL 0.286461 37.500000  -0.8540
  PXLW 0.280896 33.333333   0.1100
  ONCO 0.267326 33.333333  -2.9862
 QVCGA 0.215876 28.571429  -0.9800
  INAB 0.182959 25.000000  -0.4250
  CDTX 0.082733 27.027027 -25.0216
  LYEL 0.068507 11.111111  -3.2200
  EKSO 0.005140  0.000000  -0.6150
[2026-01-17 22:52:08,831] [INFO]: Successfully updated C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\top_candidates.csv with 15 records
[2026-01-17 22:52:08,839] [INFO]: Metrics summary CSV successfully updated: C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\metrics_summary.csv
[2026-01-17 22:52:08,839] [INFO]: Calculated Metrics: Trades=1, Net PnL=-2.59, Win Rate=0.00%, Expectancy=-2.59, Profit Factor=0.0, Max Drawdown=0.00, Sharpe=0.00, Sortino=0.00
[2026-01-17 22:52:15,975] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=15
[2026-01-17 22:52:15,976] [INFO]: [INFO] METRICS_DB_TOP_CANDIDATES_UPSERT rows=15 run_date=2026-01-02
[2026-01-17 22:52:18,290] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
[2026-01-17 22:52:18,290] [INFO]: [INFO] METRICS_DB_OK run_date=2026-01-02 total_trades=1 net_pnl=-2.590005000000019
[2026-01-17 22:52:18,296] [INFO]: Metrics calculation complete
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:600: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  end_time = datetime.utcnow()
[2026-01-17 22:52:18,297] [INFO]: Script finished in 0:00:16.540342
[2026-01-18T04:52:18.367549+00:00] END metrics rc=0 secs=17.2
[2026-01-18T05:22:12.854190+00:00] START metrics
[2026-01-17 23:22:13,479] [INFO]: Metrics script started
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:57: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  start_time = datetime.utcnow()
[2026-01-17 23:22:13,480] [INFO]: Starting metrics calculation
[2026-01-17 23:22:15,687] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-16 source=cli
[2026-01-17 23:22:18,161] [INFO]: Screener Metrics Summary: total_candidates=0, avg_score=nan
[2026-01-17 23:22:18,161] [INFO]: Top 15 Screener Symbols: 
[2026-01-17 23:22:18,163] [INFO]: Top Candidates: Empty DataFrame
Columns: [symbol, score, win_rate, net_pnl]
Index: []
[2026-01-17 23:22:18,169] [INFO]: Successfully updated C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\top_candidates.csv with 0 records
[2026-01-17 23:22:18,178] [INFO]: Metrics summary CSV successfully updated: C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\metrics_summary.csv
[2026-01-17 23:22:18,178] [INFO]: Calculated Metrics: Trades=1, Net PnL=-2.59, Win Rate=0.00%, Expectancy=-2.59, Profit Factor=0.0, Max Drawdown=0.00, Sharpe=0.00, Sortino=0.00
[2026-01-17 23:22:22,923] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
[2026-01-17 23:22:22,924] [INFO]: [INFO] METRICS_DB_OK run_date=2026-01-16 total_trades=1 net_pnl=-2.590005000000019
[2026-01-17 23:22:22,930] [INFO]: Metrics calculation complete
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:629: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  end_time = datetime.utcnow()
[2026-01-17 23:22:22,930] [INFO]: Script finished in 0:00:09.450374
[2026-01-18T05:22:23.009262+00:00] END metrics rc=0 secs=10.2
[2026-01-18T05:39:52.027199+00:00] START metrics
[2026-01-17 23:39:52,682] [INFO]: Metrics script started
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:57: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  start_time = datetime.utcnow()
[2026-01-17 23:39:52,683] [INFO]: Starting metrics calculation
[2026-01-17 23:39:54,964] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-16 source=cli
[2026-01-17 23:39:57,415] [INFO]: Screener Metrics Summary: total_candidates=13, avg_score=0.35
[2026-01-17 23:39:57,415] [INFO]: Top 15 Screener Symbols: PLUG, HMY, SRRK, FN, RGLD, SKY, HBAN, MIRM, ALK, STLD, NVST, NBIS, DHI
[2026-01-17 23:39:57,419] [INFO]: Top Candidates: symbol    score  win_rate      net_pnl
  PLUG 0.893846 64.754098  6807.410286
   HMY 0.569132 48.846154  1322.512621
  SRRK 0.567824 52.966102  1143.979745
    FN 0.444137 46.969697    31.761079
  RGLD 0.392004 44.375000   -93.842521
   SKY 0.327643 39.735099  -607.156186
  HBAN 0.325169 41.379310 -1182.384999
  MIRM 0.311678 39.737991 -2118.591433
   ALK 0.281714 39.534884 -1065.036229
  STLD 0.223148 36.419753 -2293.398950
  NVST 0.215920 34.146341 -1528.382787
  NBIS 0.000000  0.000000     0.000000
   DHI 0.000000  0.000000     0.000000
[2026-01-17 23:39:57,424] [INFO]: Successfully updated C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\top_candidates.csv with 13 records
[2026-01-17 23:39:57,433] [INFO]: Metrics summary CSV successfully updated: C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\metrics_summary.csv
[2026-01-17 23:39:57,433] [INFO]: Calculated Metrics: Trades=1, Net PnL=-2.59, Win Rate=0.00%, Expectancy=-2.59, Profit Factor=0.0, Max Drawdown=0.00, Sharpe=0.00, Sortino=0.00
[2026-01-17 23:40:04,610] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=13
[2026-01-17 23:40:04,610] [INFO]: [INFO] METRICS_DB_TOP_CANDIDATES_UPSERT rows=13 run_date=2026-01-16
[2026-01-17 23:40:07,006] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
[2026-01-17 23:40:07,007] [INFO]: [INFO] METRICS_DB_OK run_date=2026-01-16 total_trades=1 net_pnl=-2.590005000000019
[2026-01-17 23:40:07,012] [INFO]: Metrics calculation complete
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:629: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  end_time = datetime.utcnow()
[2026-01-17 23:40:07,013] [INFO]: Script finished in 0:00:14.330129
[2026-01-18T05:40:07.089834+00:00] END metrics rc=0 secs=15.1
[2026-01-18T06:01:48.093090+00:00] START metrics
[2026-01-18 00:01:48,749] [INFO]: Metrics script started
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:57: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  start_time = datetime.utcnow()
[2026-01-18 00:01:48,751] [INFO]: Starting metrics calculation
[2026-01-18 00:01:50,978] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-16 source=cli
[2026-01-18 00:01:53,556] [INFO]: Screener Metrics Summary: total_candidates=16, avg_score=0.29
[2026-01-18 00:01:53,557] [INFO]: Top 15 Screener Symbols: PLUG, SRRK, HMY, FN, RGLD, HBAN, SKY, MIRM, ALK, STLD, NVST, NBIS, DHI, TXG, HE
[2026-01-18 00:01:53,559] [INFO]: Top Candidates: symbol    score  win_rate      net_pnl
  PLUG 0.899187 64.754098  6847.756207
  SRRK 0.592224 53.333333  1320.445329
   HMY 0.565369 48.373984  1303.611636
    FN 0.454846 47.208122    58.058443
  RGLD 0.405272 44.512195   -55.281850
  HBAN 0.336238 41.714286 -1180.146859
   SKY 0.334976 39.735099  -597.755171
  MIRM 0.324547 40.178571 -2043.109331
   ALK 0.287021 39.534884 -1077.264321
  STLD 0.245727 37.125749 -2191.319786
  NVST 0.220868 33.870968 -1532.777587
  NBIS 0.000000  0.000000     0.000000
   DHI 0.000000  0.000000     0.000000
   TXG 0.000000  0.000000     0.000000
    HE 0.000000  0.000000     0.000000
[2026-01-18 00:01:53,565] [INFO]: Successfully updated C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\top_candidates.csv with 15 records
[2026-01-18 00:01:53,572] [INFO]: Metrics summary CSV successfully updated: C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\metrics_summary.csv
[2026-01-18 00:01:53,573] [INFO]: Calculated Metrics: Trades=1, Net PnL=-2.59, Win Rate=0.00%, Expectancy=-2.59, Profit Factor=0.0, Max Drawdown=0.00, Sharpe=0.00, Sortino=0.00
[2026-01-18 00:02:00,784] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=16
[2026-01-18 00:02:00,784] [INFO]: [INFO] METRICS_DB_TOP_CANDIDATES_UPSERT rows=16 run_date=2026-01-16
[2026-01-18 00:02:03,231] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
[2026-01-18 00:02:03,231] [INFO]: [INFO] METRICS_DB_OK run_date=2026-01-16 total_trades=1 net_pnl=-2.590005000000019
[2026-01-18 00:02:03,236] [INFO]: Metrics calculation complete
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:629: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  end_time = datetime.utcnow()
[2026-01-18 00:02:03,237] [INFO]: Script finished in 0:00:14.485256
[2026-01-18T06:02:03.306342+00:00] END metrics rc=0 secs=15.2
[2026-01-18T06:13:26.425475+00:00] START metrics
[2026-01-18 00:13:27,034] [INFO]: Metrics script started
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:57: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  start_time = datetime.utcnow()
[2026-01-18 00:13:27,078] [INFO]: Starting metrics calculation
[2026-01-18 00:13:29,288] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-16 source=cli
[2026-01-18 00:13:31,714] [INFO]: Screener Metrics Summary: total_candidates=16, avg_score=0.29
[2026-01-18 00:13:31,714] [INFO]: Top 15 Screener Symbols: PLUG, SRRK, HMY, FN, RGLD, HBAN, SKY, MIRM, ALK, STLD, NVST, NBIS, DHI, TXG, HE
[2026-01-18 00:13:31,717] [INFO]: Top Candidates: symbol    score  win_rate      net_pnl
  PLUG 0.899187 64.754098  6847.756207
  SRRK 0.592224 53.333333  1320.445329
   HMY 0.565369 48.373984  1303.611636
    FN 0.454846 47.208122    58.058443
  RGLD 0.405272 44.512195   -55.281850
  HBAN 0.336238 41.714286 -1180.146859
   SKY 0.334976 39.735099  -597.755171
  MIRM 0.324547 40.178571 -2043.109331
   ALK 0.287021 39.534884 -1077.264321
  STLD 0.245727 37.125749 -2191.319786
  NVST 0.220868 33.870968 -1532.777587
  NBIS 0.000000  0.000000     0.000000
   DHI 0.000000  0.000000     0.000000
   TXG 0.000000  0.000000     0.000000
    HE 0.000000  0.000000     0.000000
[2026-01-18 00:13:31,724] [INFO]: Successfully updated C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\top_candidates.csv with 15 records
[2026-01-18 00:13:31,732] [INFO]: Metrics summary CSV successfully updated: C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\metrics_summary.csv
[2026-01-18 00:13:31,733] [INFO]: Calculated Metrics: Trades=1, Net PnL=-2.59, Win Rate=0.00%, Expectancy=-2.59, Profit Factor=0.0, Max Drawdown=0.00, Sharpe=0.00, Sortino=0.00
[2026-01-18 00:13:38,966] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=16
[2026-01-18 00:13:38,967] [INFO]: [INFO] METRICS_DB_TOP_CANDIDATES_UPSERT rows=16 run_date=2026-01-16
[2026-01-18 00:13:41,789] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
[2026-01-18 00:13:41,789] [INFO]: [INFO] METRICS_DB_OK run_date=2026-01-16 total_trades=1 net_pnl=-2.590005000000019
[2026-01-18 00:13:41,795] [INFO]: Metrics calculation complete
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:629: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  end_time = datetime.utcnow()
[2026-01-18 00:13:41,795] [INFO]: Script finished in 0:00:14.717430
[2026-01-18T06:13:41.877006+00:00] END metrics rc=0 secs=15.5
[2026-01-18T06:23:19.691649+00:00] START metrics
[2026-01-18 00:23:20,324] [INFO]: Metrics script started
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:57: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  start_time = datetime.utcnow()
[2026-01-18 00:23:20,325] [INFO]: Starting metrics calculation
[2026-01-18 00:23:22,518] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-16 source=cli
[2026-01-18 00:23:24,979] [INFO]: Screener Metrics Summary: total_candidates=16, avg_score=0.29
[2026-01-18 00:23:24,979] [INFO]: Top 15 Screener Symbols: PLUG, SRRK, HMY, FN, RGLD, HBAN, SKY, MIRM, ALK, STLD, NVST, NBIS, DHI, TXG, HE
[2026-01-18 00:23:24,981] [INFO]: Top Candidates: symbol    score  win_rate      net_pnl
  PLUG 0.899187 64.754098  6847.756207
  SRRK 0.592224 53.333333  1320.445329
   HMY 0.565369 48.373984  1303.611636
    FN 0.454846 47.208122    58.058443
  RGLD 0.405272 44.512195   -55.281850
  HBAN 0.336238 41.714286 -1180.146859
   SKY 0.334976 39.735099  -597.755171
  MIRM 0.324547 40.178571 -2043.109331
   ALK 0.287021 39.534884 -1077.264321
  STLD 0.245727 37.125749 -2191.319786
  NVST 0.220868 33.870968 -1532.777587
  NBIS 0.000000  0.000000     0.000000
   DHI 0.000000  0.000000     0.000000
   TXG 0.000000  0.000000     0.000000
    HE 0.000000  0.000000     0.000000
[2026-01-18 00:23:24,987] [INFO]: Successfully updated C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\top_candidates.csv with 15 records
[2026-01-18 00:23:24,995] [INFO]: Metrics summary CSV successfully updated: C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\metrics_summary.csv
[2026-01-18 00:23:24,995] [INFO]: Calculated Metrics: Trades=1, Net PnL=-2.59, Win Rate=0.00%, Expectancy=-2.59, Profit Factor=0.0, Max Drawdown=0.00, Sharpe=0.00, Sortino=0.00
[2026-01-18 00:23:27,348] [WARNING]: [WARN] METRICS_TOP_CANDIDATES_FILTERED dropped=13 remaining=3
[2026-01-18 00:23:32,248] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=3
[2026-01-18 00:23:32,248] [INFO]: [INFO] METRICS_DB_TOP_CANDIDATES_UPSERT rows=3 run_date=2026-01-16
[2026-01-18 00:23:34,599] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
[2026-01-18 00:23:34,599] [INFO]: [INFO] METRICS_DB_OK run_date=2026-01-16 total_trades=1 net_pnl=-2.590005000000019
[2026-01-18 00:23:34,603] [INFO]: Metrics calculation complete
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:638: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  end_time = datetime.utcnow()
[2026-01-18 00:23:34,603] [INFO]: Script finished in 0:00:14.278372
[2026-01-18T06:23:34.671696+00:00] END metrics rc=0 secs=15.0
[2026-01-18T06:35:28.236360+00:00] START metrics
[2026-01-18 00:35:28,961] [INFO]: Metrics script started
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:57: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  start_time = datetime.utcnow()
[2026-01-18 00:35:28,962] [INFO]: Starting metrics calculation
[2026-01-18 00:35:31,208] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-16 source=cli
[2026-01-18 00:35:33,641] [INFO]: Screener Metrics Summary: total_candidates=16, avg_score=0.29
[2026-01-18 00:35:33,641] [INFO]: Top 15 Screener Symbols: PLUG, SRRK, HMY, FN, RGLD, HBAN, SKY, MIRM, ALK, STLD, NVST, NBIS, DHI, TXG, HE
[2026-01-18 00:35:33,644] [INFO]: Top Candidates: symbol    score  win_rate      net_pnl
  PLUG 0.899187 64.754098  6847.756207
  SRRK 0.592224 53.333333  1320.445329
   HMY 0.565369 48.373984  1303.611636
    FN 0.454846 47.208122    58.058443
  RGLD 0.405272 44.512195   -55.281850
  HBAN 0.336238 41.714286 -1180.146859
   SKY 0.334976 39.735099  -597.755171
  MIRM 0.324547 40.178571 -2043.109331
   ALK 0.287021 39.534884 -1077.264321
  STLD 0.245727 37.125749 -2191.319786
  NVST 0.220868 33.870968 -1532.777587
  NBIS 0.000000  0.000000     0.000000
   DHI 0.000000  0.000000     0.000000
   TXG 0.000000  0.000000     0.000000
    HE 0.000000  0.000000     0.000000
[2026-01-18 00:35:33,649] [INFO]: Successfully updated C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\top_candidates.csv with 15 records
[2026-01-18 00:35:33,657] [INFO]: Metrics summary CSV successfully updated: C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\metrics_summary.csv
[2026-01-18 00:35:33,657] [INFO]: Calculated Metrics: Trades=1, Net PnL=-2.59, Win Rate=0.00%, Expectancy=-2.59, Profit Factor=0.0, Max Drawdown=0.00, Sharpe=0.00, Sortino=0.00
[2026-01-18 00:35:36,032] [WARNING]: [WARN] METRICS_TOP_CANDIDATES_FILTERED dropped=13 remaining=3
[2026-01-18 00:35:40,958] [INFO]: [INFO] TOP_CANDIDATES_REPLACED run_date=2026-01-16 deleted=16
[2026-01-18 00:35:41,059] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=3
[2026-01-18 00:35:41,059] [INFO]: [INFO] METRICS_DB_TOP_CANDIDATES_UPSERT rows=3 run_date=2026-01-16
[2026-01-18 00:35:43,420] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
[2026-01-18 00:35:43,420] [INFO]: [INFO] METRICS_DB_OK run_date=2026-01-16 total_trades=1 net_pnl=-2.590005000000019
[2026-01-18 00:35:43,424] [INFO]: Metrics calculation complete
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:638: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  end_time = datetime.utcnow()
[2026-01-18 00:35:43,424] [INFO]: Script finished in 0:00:14.462038
[2026-01-18T06:35:43.499514+00:00] END metrics rc=0 secs=15.3
[2026-01-18T06:57:41.228402+00:00] START metrics
[2026-01-18 00:57:42,051] [INFO]: Metrics script started
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:57: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  start_time = datetime.utcnow()
[2026-01-18 00:57:42,052] [INFO]: Starting metrics calculation
[2026-01-18 00:57:44,257] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-16 source=cli
[2026-01-18 00:57:46,705] [INFO]: Screener Metrics Summary: total_candidates=16, avg_score=0.29
[2026-01-18 00:57:46,705] [INFO]: Top 15 Screener Symbols: PLUG, SRRK, HMY, FN, RGLD, HBAN, SKY, MIRM, ALK, STLD, NVST, NBIS, DHI, TXG, HE
[2026-01-18 00:57:46,708] [INFO]: Top Candidates: symbol    score  win_rate      net_pnl
  PLUG 0.899187 64.754098  6847.756207
  SRRK 0.592224 53.333333  1320.445329
   HMY 0.565369 48.373984  1303.611636
    FN 0.454846 47.208122    58.058443
  RGLD 0.405272 44.512195   -55.281850
  HBAN 0.336238 41.714286 -1180.146859
   SKY 0.334976 39.735099  -597.755171
  MIRM 0.324547 40.178571 -2043.109331
   ALK 0.287021 39.534884 -1077.264321
  STLD 0.245727 37.125749 -2191.319786
  NVST 0.220868 33.870968 -1532.777587
  NBIS 0.000000  0.000000     0.000000
   DHI 0.000000  0.000000     0.000000
   TXG 0.000000  0.000000     0.000000
    HE 0.000000  0.000000     0.000000
[2026-01-18 00:57:46,714] [INFO]: Successfully updated C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\top_candidates.csv with 15 records
[2026-01-18 00:57:46,722] [INFO]: Metrics summary CSV successfully updated: C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\metrics_summary.csv
[2026-01-18 00:57:46,722] [INFO]: Calculated Metrics: Trades=1, Net PnL=-2.59, Win Rate=0.00%, Expectancy=-2.59, Profit Factor=0.0, Max Drawdown=0.00, Sharpe=0.00, Sortino=0.00
[2026-01-18 00:57:49,158] [WARNING]: [WARN] METRICS_TOP_CANDIDATES_FILTERED dropped=13 remaining=3
[2026-01-18 00:57:53,902] [INFO]: [INFO] TOP_CANDIDATES_REPLACED run_date=2026-01-16 deleted=3
[2026-01-18 00:57:53,988] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=3
[2026-01-18 00:57:53,989] [INFO]: [INFO] METRICS_DB_TOP_CANDIDATES_UPSERT rows=3 run_date=2026-01-16
[2026-01-18 00:57:56,325] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
[2026-01-18 00:57:56,326] [INFO]: [INFO] METRICS_DB_OK run_date=2026-01-16 total_trades=1 net_pnl=-2.590005000000019
[2026-01-18 00:57:56,330] [INFO]: Metrics calculation complete
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:638: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  end_time = datetime.utcnow()
[2026-01-18 00:57:56,330] [INFO]: Script finished in 0:00:14.278014
[2026-01-18T06:57:56.414237+00:00] END metrics rc=0 secs=15.2
[2026-01-18T07:07:56.659052+00:00] START metrics
[2026-01-18 01:07:57,369] [INFO]: Metrics script started
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:57: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  start_time = datetime.utcnow()
[2026-01-18 01:07:57,370] [INFO]: Starting metrics calculation
[2026-01-18 01:07:59,628] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-16 source=cli
[2026-01-18 01:08:02,176] [INFO]: Screener Metrics Summary: total_candidates=16, avg_score=0.29
[2026-01-18 01:08:02,176] [INFO]: Top 15 Screener Symbols: PLUG, SRRK, HMY, FN, RGLD, HBAN, SKY, MIRM, ALK, STLD, NVST, NBIS, DHI, TXG, HE
[2026-01-18 01:08:02,179] [INFO]: Top Candidates: symbol    score  win_rate      net_pnl
  PLUG 0.899187 64.754098  6847.756207
  SRRK 0.592224 53.333333  1320.445329
   HMY 0.565369 48.373984  1303.611636
    FN 0.454846 47.208122    58.058443
  RGLD 0.405272 44.512195   -55.281850
  HBAN 0.336238 41.714286 -1180.146859
   SKY 0.334976 39.735099  -597.755171
  MIRM 0.324547 40.178571 -2043.109331
   ALK 0.287021 39.534884 -1077.264321
  STLD 0.245727 37.125749 -2191.319786
  NVST 0.220868 33.870968 -1532.777587
  NBIS 0.000000  0.000000     0.000000
   DHI 0.000000  0.000000     0.000000
   TXG 0.000000  0.000000     0.000000
    HE 0.000000  0.000000     0.000000
[2026-01-18 01:08:02,185] [INFO]: Successfully updated C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\top_candidates.csv with 15 records
[2026-01-18 01:08:02,193] [INFO]: Metrics summary CSV successfully updated: C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\metrics_summary.csv
[2026-01-18 01:08:02,193] [INFO]: Calculated Metrics: Trades=1, Net PnL=-2.59, Win Rate=0.00%, Expectancy=-2.59, Profit Factor=0.0, Max Drawdown=0.00, Sharpe=0.00, Sortino=0.00
[2026-01-18 01:08:04,586] [WARNING]: [WARN] METRICS_TOP_CANDIDATES_FILTERED dropped=13 remaining=3
[2026-01-18 01:08:09,517] [INFO]: [INFO] TOP_CANDIDATES_REPLACED run_date=2026-01-16 deleted=3
[2026-01-18 01:08:09,637] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=3
[2026-01-18 01:08:09,638] [INFO]: [INFO] METRICS_DB_TOP_CANDIDATES_UPSERT rows=3 run_date=2026-01-16
[2026-01-18 01:08:12,004] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
[2026-01-18 01:08:12,004] [INFO]: [INFO] METRICS_DB_OK run_date=2026-01-16 total_trades=1 net_pnl=-2.590005000000019
[2026-01-18 01:08:12,011] [INFO]: Metrics calculation complete
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:638: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  end_time = datetime.utcnow()
[2026-01-18 01:08:12,011] [INFO]: Script finished in 0:00:14.640816
[2026-01-18T07:08:12.084759+00:00] END metrics rc=0 secs=15.4
[2026-01-18T16:26:49.696286+00:00] START metrics
[2026-01-18 10:26:50,426] [INFO]: Metrics script started
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:57: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  start_time = datetime.utcnow()
[2026-01-18 10:26:50,426] [INFO]: Starting metrics calculation
[2026-01-18 10:26:52,698] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-16 source=cli
[2026-01-18 10:26:55,265] [INFO]: Screener Metrics Summary: total_candidates=16, avg_score=0.29
[2026-01-18 10:26:55,265] [INFO]: Top 15 Screener Symbols: PLUG, SRRK, HMY, FN, RGLD, HBAN, SKY, MIRM, ALK, STLD, NVST, NBIS, DHI, TXG, HE
[2026-01-18 10:26:55,267] [INFO]: Top Candidates: symbol    score  win_rate      net_pnl
  PLUG 0.899187 64.754098  6847.756207
  SRRK 0.592224 53.333333  1320.445329
   HMY 0.565369 48.373984  1303.611636
    FN 0.454846 47.208122    58.058443
  RGLD 0.405272 44.512195   -55.281850
  HBAN 0.336238 41.714286 -1180.146859
   SKY 0.334976 39.735099  -597.755171
  MIRM 0.324547 40.178571 -2043.109331
   ALK 0.287021 39.534884 -1077.264321
  STLD 0.245727 37.125749 -2191.319786
  NVST 0.220868 33.870968 -1532.777587
  NBIS 0.000000  0.000000     0.000000
   DHI 0.000000  0.000000     0.000000
   TXG 0.000000  0.000000     0.000000
    HE 0.000000  0.000000     0.000000
[2026-01-18 10:26:55,272] [INFO]: Successfully updated C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\top_candidates.csv with 15 records
[2026-01-18 10:26:55,280] [INFO]: Metrics summary CSV successfully updated: C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\metrics_summary.csv
[2026-01-18 10:26:55,280] [INFO]: Calculated Metrics: Trades=1, Net PnL=-2.59, Win Rate=0.00%, Expectancy=-2.59, Profit Factor=0.0, Max Drawdown=0.00, Sharpe=0.00, Sortino=0.00
[2026-01-18 10:26:57,607] [WARNING]: [WARN] METRICS_TOP_CANDIDATES_FILTERED dropped=13 remaining=3
[2026-01-18 10:27:02,408] [INFO]: [INFO] TOP_CANDIDATES_REPLACED run_date=2026-01-16 deleted=3
[2026-01-18 10:27:02,518] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=3
[2026-01-18 10:27:02,519] [INFO]: [INFO] METRICS_DB_TOP_CANDIDATES_UPSERT rows=3 run_date=2026-01-16
[2026-01-18 10:27:04,983] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
[2026-01-18 10:27:04,984] [INFO]: [INFO] METRICS_DB_OK run_date=2026-01-16 total_trades=1 net_pnl=-2.590005000000019
[2026-01-18 10:27:04,990] [INFO]: Metrics calculation complete
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:638: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  end_time = datetime.utcnow()
[2026-01-18 10:27:04,990] [INFO]: Script finished in 0:00:14.563690
[2026-01-18T16:27:05.071623+00:00] END metrics rc=0 secs=15.4
[2026-01-18T16:40:08.844892+00:00] START metrics
[2026-01-18 10:40:09,542] [INFO]: Metrics script started
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:57: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  start_time = datetime.utcnow()
[2026-01-18 10:40:09,542] [INFO]: Starting metrics calculation
[2026-01-18 10:40:11,750] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-16 source=cli
[2026-01-18 10:40:14,236] [INFO]: Screener Metrics Summary: total_candidates=16, avg_score=0.29
[2026-01-18 10:40:14,236] [INFO]: Top 15 Screener Symbols: PLUG, SRRK, HMY, FN, RGLD, HBAN, SKY, MIRM, ALK, STLD, NVST, NBIS, DHI, TXG, HE
[2026-01-18 10:40:14,238] [INFO]: Top Candidates: symbol    score  win_rate      net_pnl
  PLUG 0.899187 64.754098  6847.756207
  SRRK 0.592224 53.333333  1320.445329
   HMY 0.565369 48.373984  1303.611636
    FN 0.454846 47.208122    58.058443
  RGLD 0.405272 44.512195   -55.281850
  HBAN 0.336238 41.714286 -1180.146859
   SKY 0.334976 39.735099  -597.755171
  MIRM 0.324547 40.178571 -2043.109331
   ALK 0.287021 39.534884 -1077.264321
  STLD 0.245727 37.125749 -2191.319786
  NVST 0.220868 33.870968 -1532.777587
  NBIS 0.000000  0.000000     0.000000
   DHI 0.000000  0.000000     0.000000
   TXG 0.000000  0.000000     0.000000
    HE 0.000000  0.000000     0.000000
[2026-01-18 10:40:14,245] [INFO]: Successfully updated C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\top_candidates.csv with 15 records
[2026-01-18 10:40:14,253] [INFO]: Metrics summary CSV successfully updated: C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\metrics_summary.csv
[2026-01-18 10:40:14,253] [INFO]: Calculated Metrics: Trades=1, Net PnL=-2.59, Win Rate=0.00%, Expectancy=-2.59, Profit Factor=0.0, Max Drawdown=0.00, Sharpe=0.00, Sortino=0.00
[2026-01-18 10:40:16,616] [WARNING]: [WARN] METRICS_TOP_CANDIDATES_FILTERED dropped=13 remaining=3
[2026-01-18 10:40:21,317] [INFO]: [INFO] TOP_CANDIDATES_REPLACED run_date=2026-01-16 deleted=3
[2026-01-18 10:40:21,402] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=3
[2026-01-18 10:40:21,402] [INFO]: [INFO] METRICS_DB_TOP_CANDIDATES_UPSERT rows=3 run_date=2026-01-16
[2026-01-18 10:40:23,762] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
[2026-01-18 10:40:23,762] [INFO]: [INFO] METRICS_DB_OK run_date=2026-01-16 total_trades=1 net_pnl=-2.590005000000019
[2026-01-18 10:40:23,768] [INFO]: Metrics calculation complete
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:638: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  end_time = datetime.utcnow()
[2026-01-18 10:40:23,769] [INFO]: Script finished in 0:00:14.226182
[2026-01-18T16:40:23.841449+00:00] END metrics rc=0 secs=15.0
[2026-01-18T17:00:39.911279+00:00] START metrics
[2026-01-18 11:00:40,740] [INFO]: Metrics script started
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:57: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  start_time = datetime.utcnow()
[2026-01-18 11:00:40,741] [INFO]: Starting metrics calculation
[2026-01-18 11:00:42,950] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-16 source=cli
[2026-01-18 11:00:45,394] [INFO]: Screener Metrics Summary: total_candidates=16, avg_score=0.29
[2026-01-18 11:00:45,394] [INFO]: Top 15 Screener Symbols: PLUG, SRRK, HMY, FN, RGLD, HBAN, SKY, MIRM, ALK, STLD, NVST, NBIS, DHI, TXG, HE
[2026-01-18 11:00:45,397] [INFO]: Top Candidates: symbol    score  win_rate      net_pnl
  PLUG 0.899187 64.754098  6847.756207
  SRRK 0.592224 53.333333  1320.445329
   HMY 0.565369 48.373984  1303.611636
    FN 0.454846 47.208122    58.058443
  RGLD 0.405272 44.512195   -55.281850
  HBAN 0.336238 41.714286 -1180.146859
   SKY 0.334976 39.735099  -597.755171
  MIRM 0.324547 40.178571 -2043.109331
   ALK 0.287021 39.534884 -1077.264321
  STLD 0.245727 37.125749 -2191.319786
  NVST 0.220868 33.870968 -1532.777587
  NBIS 0.000000  0.000000     0.000000
   DHI 0.000000  0.000000     0.000000
   TXG 0.000000  0.000000     0.000000
    HE 0.000000  0.000000     0.000000
[2026-01-18 11:00:45,404] [INFO]: Successfully updated C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\top_candidates.csv with 15 records
[2026-01-18 11:00:45,412] [INFO]: Metrics summary CSV successfully updated: C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\metrics_summary.csv
[2026-01-18 11:00:45,413] [INFO]: Calculated Metrics: Trades=1, Net PnL=-2.59, Win Rate=0.00%, Expectancy=-2.59, Profit Factor=0.0, Max Drawdown=0.00, Sharpe=0.00, Sortino=0.00
[2026-01-18 11:00:47,743] [WARNING]: [WARN] METRICS_TOP_CANDIDATES_FILTERED dropped=13 remaining=3
[2026-01-18 11:00:52,524] [INFO]: [INFO] TOP_CANDIDATES_REPLACED run_date=2026-01-16 deleted=3
[2026-01-18 11:00:52,624] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=3
[2026-01-18 11:00:52,624] [INFO]: [INFO] METRICS_DB_TOP_CANDIDATES_UPSERT rows=3 run_date=2026-01-16
[2026-01-18 11:00:55,011] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
[2026-01-18 11:00:55,011] [INFO]: [INFO] METRICS_DB_OK run_date=2026-01-16 total_trades=1 net_pnl=-2.590005000000019
[2026-01-18 11:00:55,015] [INFO]: Metrics calculation complete
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:638: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  end_time = datetime.utcnow()
[2026-01-18 11:00:55,015] [INFO]: Script finished in 0:00:14.274213
[2026-01-18T17:00:55.086843+00:00] END metrics rc=0 secs=15.2
[2026-01-18T17:03:29.027514+00:00] START metrics
[2026-01-18 11:03:29,780] [INFO]: Metrics script started
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:57: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  start_time = datetime.utcnow()
[2026-01-18 11:03:29,781] [INFO]: Starting metrics calculation
[2026-01-18 11:03:32,597] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-16 source=cli
[2026-01-18 11:03:35,085] [INFO]: Screener Metrics Summary: total_candidates=16, avg_score=0.29
[2026-01-18 11:03:35,086] [INFO]: Top 15 Screener Symbols: PLUG, SRRK, HMY, FN, RGLD, HBAN, SKY, MIRM, ALK, STLD, NVST, NBIS, DHI, TXG, HE
[2026-01-18 11:03:35,088] [INFO]: Top Candidates: symbol    score  win_rate      net_pnl
  PLUG 0.899187 64.754098  6847.756207
  SRRK 0.592224 53.333333  1320.445329
   HMY 0.565369 48.373984  1303.611636
    FN 0.454846 47.208122    58.058443
  RGLD 0.405272 44.512195   -55.281850
  HBAN 0.336238 41.714286 -1180.146859
   SKY 0.334976 39.735099  -597.755171
  MIRM 0.324547 40.178571 -2043.109331
   ALK 0.287021 39.534884 -1077.264321
  STLD 0.245727 37.125749 -2191.319786
  NVST 0.220868 33.870968 -1532.777587
  NBIS 0.000000  0.000000     0.000000
   DHI 0.000000  0.000000     0.000000
   TXG 0.000000  0.000000     0.000000
    HE 0.000000  0.000000     0.000000
[2026-01-18 11:03:35,095] [INFO]: Successfully updated C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\top_candidates.csv with 15 records
[2026-01-18 11:03:35,102] [INFO]: Metrics summary CSV successfully updated: C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\metrics_summary.csv
[2026-01-18 11:03:35,103] [INFO]: Calculated Metrics: Trades=1, Net PnL=-2.59, Win Rate=0.00%, Expectancy=-2.59, Profit Factor=0.0, Max Drawdown=0.00, Sharpe=0.00, Sortino=0.00
[2026-01-18 11:03:37,512] [WARNING]: [WARN] METRICS_TOP_CANDIDATES_FILTERED dropped=13 remaining=3
[2026-01-18 11:03:44,878] [INFO]: [INFO] TOP_CANDIDATES_REPLACED run_date=2026-01-16 deleted=3
[2026-01-18 11:03:45,376] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=3
[2026-01-18 11:03:45,377] [INFO]: [INFO] METRICS_DB_TOP_CANDIDATES_UPSERT rows=3 run_date=2026-01-16
[2026-01-18 11:03:47,984] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
[2026-01-18 11:03:47,984] [INFO]: [INFO] METRICS_DB_OK run_date=2026-01-16 total_trades=1 net_pnl=-2.590005000000019
[2026-01-18 11:03:47,989] [INFO]: Metrics calculation complete
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:638: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  end_time = datetime.utcnow()
[2026-01-18 11:03:47,989] [INFO]: Script finished in 0:00:18.208824
[2026-01-18T17:03:48.068527+00:00] END metrics rc=0 secs=19.0
[2026-01-18T17:20:03.849889+00:00] START metrics
[2026-01-18 11:20:04,834] [INFO]: Metrics script started
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:57: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  start_time = datetime.utcnow()
[2026-01-18 11:20:04,835] [INFO]: Starting metrics calculation
[2026-01-18 11:20:07,074] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-16 source=cli
[2026-01-18 11:20:09,746] [INFO]: Screener Metrics Summary: total_candidates=16, avg_score=0.29
[2026-01-18 11:20:09,747] [INFO]: Top 15 Screener Symbols: PLUG, SRRK, HMY, FN, RGLD, HBAN, SKY, MIRM, ALK, STLD, NVST, NBIS, DHI, TXG, HE
[2026-01-18 11:20:09,749] [INFO]: Top Candidates: symbol    score  win_rate      net_pnl
  PLUG 0.899187 64.754098  6847.756207
  SRRK 0.592224 53.333333  1320.445329
   HMY 0.565369 48.373984  1303.611636
    FN 0.454846 47.208122    58.058443
  RGLD 0.405272 44.512195   -55.281850
  HBAN 0.336238 41.714286 -1180.146859
   SKY 0.334976 39.735099  -597.755171
  MIRM 0.324547 40.178571 -2043.109331
   ALK 0.287021 39.534884 -1077.264321
  STLD 0.245727 37.125749 -2191.319786
  NVST 0.220868 33.870968 -1532.777587
  NBIS 0.000000  0.000000     0.000000
   DHI 0.000000  0.000000     0.000000
   TXG 0.000000  0.000000     0.000000
    HE 0.000000  0.000000     0.000000
[2026-01-18 11:20:09,755] [INFO]: Successfully updated C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\top_candidates.csv with 15 records
[2026-01-18 11:20:09,763] [INFO]: Metrics summary CSV successfully updated: C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\metrics_summary.csv
[2026-01-18 11:20:09,763] [INFO]: Calculated Metrics: Trades=1, Net PnL=-2.59, Win Rate=0.00%, Expectancy=-2.59, Profit Factor=0.0, Max Drawdown=0.00, Sharpe=0.00, Sortino=0.00
[2026-01-18 11:20:12,786] [WARNING]: [WARN] METRICS_TOP_CANDIDATES_FILTERED dropped=13 remaining=3
[2026-01-18 11:20:18,683] [INFO]: [INFO] TOP_CANDIDATES_REPLACED run_date=2026-01-16 deleted=3
[2026-01-18 11:20:18,880] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=3
[2026-01-18 11:20:18,880] [INFO]: [INFO] METRICS_DB_TOP_CANDIDATES_UPSERT rows=3 run_date=2026-01-16
[2026-01-18 11:20:21,401] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
[2026-01-18 11:20:21,401] [INFO]: [INFO] METRICS_DB_OK run_date=2026-01-16 total_trades=1 net_pnl=-2.590005000000019
[2026-01-18 11:20:21,405] [INFO]: Metrics calculation complete
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:638: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  end_time = datetime.utcnow()
[2026-01-18 11:20:21,405] [INFO]: Script finished in 0:00:16.570233
[2026-01-18T17:20:21.692168+00:00] END metrics rc=0 secs=17.8
[2026-01-18T17:33:16.940643+00:00] START metrics
[2026-01-18 11:33:17,688] [INFO]: Metrics script started
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:57: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  start_time = datetime.utcnow()
[2026-01-18 11:33:17,688] [INFO]: Starting metrics calculation
[2026-01-18 11:33:19,871] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-15 source=cli
[2026-01-18 11:33:22,385] [INFO]: Screener Metrics Summary: total_candidates=0, avg_score=nan
[2026-01-18 11:33:22,385] [INFO]: Top 15 Screener Symbols: 
[2026-01-18 11:33:22,387] [INFO]: Top Candidates: Empty DataFrame
Columns: [symbol, score, win_rate, net_pnl]
Index: []
[2026-01-18 11:33:22,395] [INFO]: Successfully updated C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\top_candidates.csv with 0 records
[2026-01-18 11:33:22,405] [INFO]: Metrics summary CSV successfully updated: C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\metrics_summary.csv
[2026-01-18 11:33:22,405] [INFO]: Calculated Metrics: Trades=1, Net PnL=-2.59, Win Rate=0.00%, Expectancy=-2.59, Profit Factor=0.0, Max Drawdown=0.00, Sharpe=0.00, Sortino=0.00
[2026-01-18 11:33:29,552] [INFO]: [INFO] TOP_CANDIDATES_REPLACED run_date=2026-01-15 deleted=0
[2026-01-18 11:33:29,616] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=0
[2026-01-18 11:33:29,617] [INFO]: [INFO] METRICS_DB_TOP_CANDIDATES_UPSERT rows=0 run_date=2026-01-15
[2026-01-18 11:33:31,963] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
[2026-01-18 11:33:31,963] [INFO]: [INFO] METRICS_DB_OK run_date=2026-01-15 total_trades=1 net_pnl=-2.590005000000019
[2026-01-18 11:33:31,970] [INFO]: Metrics calculation complete
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:638: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  end_time = datetime.utcnow()
[2026-01-18 11:33:31,971] [INFO]: Script finished in 0:00:14.282647
[2026-01-18T17:33:32.049930+00:00] END metrics rc=0 secs=15.1
[2026-01-18T18:07:08.617700+00:00] START metrics
[2026-01-18 12:07:09,299] [INFO]: Metrics script started
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:77: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  start_time = datetime.utcnow()
[2026-01-18 12:07:09,300] [INFO]: Starting metrics calculation
[2026-01-18 12:07:11,472] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-16 source=cli
[2026-01-18 12:07:14,008] [INFO]: Screener Metrics Summary: total_candidates=16, avg_score=0.29
[2026-01-18 12:07:14,009] [INFO]: Top 15 Screener Symbols: PLUG, SRRK, HMY, FN, RGLD, HBAN, SKY, MIRM, ALK, STLD, NVST, NBIS, DHI, TXG, HE
[2026-01-18 12:07:14,011] [INFO]: Top Candidates: symbol    score  win_rate      net_pnl
  PLUG 0.899187 64.754098  6847.756207
  SRRK 0.592224 53.333333  1320.445329
   HMY 0.565369 48.373984  1303.611636
    FN 0.454846 47.208122    58.058443
  RGLD 0.405272 44.512195   -55.281850
  HBAN 0.336238 41.714286 -1180.146859
   SKY 0.334976 39.735099  -597.755171
  MIRM 0.324547 40.178571 -2043.109331
   ALK 0.287021 39.534884 -1077.264321
  STLD 0.245727 37.125749 -2191.319786
  NVST 0.220868 33.870968 -1532.777587
  NBIS 0.000000  0.000000     0.000000
   DHI 0.000000  0.000000     0.000000
   TXG 0.000000  0.000000     0.000000
    HE 0.000000  0.000000     0.000000
[2026-01-18 12:07:14,011] [INFO]: [INFO] TOP_CANDIDATES_CSV_SKIPPED reason=db_enabled
[2026-01-18 12:07:14,022] [INFO]: Metrics summary CSV successfully updated: C:\Users\RasPa\JBravoGit\JBRAVO_Screener\data\metrics_summary.csv
[2026-01-18 12:07:14,022] [INFO]: Calculated Metrics: Trades=1, Net PnL=-2.59, Win Rate=0.00%, Expectancy=-2.59, Profit Factor=0.0, Max Drawdown=0.00, Sharpe=0.00, Sortino=0.00
[2026-01-18 12:07:16,377] [WARNING]: [WARN] METRICS_TOP_CANDIDATES_FILTERED dropped=13 remaining=3
[2026-01-18 12:07:21,177] [INFO]: [INFO] TOP_CANDIDATES_REPLACED run_date=2026-01-16 deleted=3
[2026-01-18 12:07:21,281] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=3
[2026-01-18 12:07:23,712] [INFO]: [INFO] METRICS_DB_TOP_CANDIDATES_UPSERT rows=3 run_date=2026-01-16
[2026-01-18 12:07:26,044] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
[2026-01-18 12:07:26,045] [INFO]: [INFO] METRICS_DB_OK run_date=2026-01-16 total_trades=1 net_pnl=-2.590005000000019
[2026-01-18 12:07:26,050] [INFO]: Metrics calculation complete
C:\Users\RasPa\JBravoGit\JBRAVO_Screener\scripts\metrics.py:661: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  end_time = datetime.utcnow()
[2026-01-18 12:07:26,051] [INFO]: Script finished in 0:00:16.750876
[2026-01-18T18:07:26.125481+00:00] END metrics rc=0 secs=17.5
[2026-01-22T15:36:21.407979+00:00] START metrics
[2026-01-22 15:36:22,905] [INFO]: Metrics script started
[2026-01-22 15:36:22,906] [INFO]: Starting metrics calculation
[2026-01-22 15:36:22,924] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-21 source=cli
[2026-01-22 15:36:22,958] [INFO]: Screener Metrics Summary: total_candidates=15, avg_score=0.39
[2026-01-22 15:36:22,958] [INFO]: Top 15 Screener Symbols: LCID, TMDX, RACE, IAG, CGON, MMYT, MIDD, IBKR, QGEN, ALKS, SARO, KRC, WLK, MKSI, FIS
[2026-01-22 15:36:22,964] [INFO]: Top Candidates: symbol    score  win_rate      net_pnl
  LCID 0.882540 64.285714  9402.378350
  TMDX 0.752847 53.741497  6018.692700
  RACE 0.462952 49.275362  1514.194079
   IAG 0.455637 46.683047  -529.585732
  CGON 0.386494 50.847458   669.903529
  MMYT 0.356828 46.232877 -1641.843543
  MIDD 0.334309 40.566038  -347.164357
  IBKR 0.325267 41.131105 -2903.173986
  QGEN 0.310656 40.540541  -601.766645
  ALKS 0.301069 39.297125 -2241.903429
  SARO 0.289753 44.444444     9.313764
   KRC 0.260317 39.215686 -1191.237398
   WLK 0.255373 38.783270 -2679.600085
  MKSI 0.248714 37.759336 -2391.919971
   FIS 0.208537 38.400000 -1837.560824
[2026-01-22 15:36:22,970] [INFO]: Calculated Metrics: Trades=2, Net PnL=74.69, Win Rate=50.00%, Expectancy=37.34, Profit Factor=29.837780235945516, Max Drawdown=-2.59, Sharpe=1.31, Sortino=0.00
[2026-01-22 15:36:23,020] [INFO]: [INFO] TOP_CANDIDATES_REPLACED run_date=2026-01-21 deleted=0
[2026-01-22 15:36:23,030] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=15
[2026-01-22 15:36:23,043] [WARNING]: [WARN] DB_SCHEMA_FAILED view=latest_top_candidates err=must be owner of view latest_top_candidates

[2026-01-22 15:36:23,043] [INFO]: [INFO] DB_TOP_CANDIDATES rows=15
[2026-01-22 15:36:23,060] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
[2026-01-22 15:36:23,061] [INFO]: [INFO] METRICS_DB_OK run_date=2026-01-21 total_trades=2 net_pnl=74.68999500000062
[2026-01-22 15:36:23,074] [INFO]: Metrics calculation complete
[2026-01-22 15:36:23,074] [INFO]: Script finished in 0:00:00.168361
[2026-01-22T15:36:23.240530+00:00] END metrics rc=0 secs=1.8
[2026-01-22T16:46:42.250200+00:00] START metrics
[2026-01-22 16:46:43,557] [INFO]: Metrics script started
[2026-01-22 16:46:43,557] [INFO]: Starting metrics calculation
[2026-01-22 16:46:43,578] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-21 source=cli
[2026-01-22 16:46:43,613] [INFO]: [DEBUG] Ranked candidates dataframe shape: (15, 17)
[2026-01-22 16:46:43,613] [INFO]: [DEBUG] Ranked candidates columns: ['run_date', 'symbol', 'trades', 'win_rate', 'net_pnl', 'expectancy', 'profit_factor', 'max_drawdown', 'sharpe', 'sortino', 'created_at', 'avg_return', 'win_rate_norm', 'net_pnl_norm', 'trades_norm', 'avg_return_norm', 'score']
[2026-01-22 16:46:43,614] [INFO]: Screener Metrics Summary: total_candidates=15, avg_score=0.39
[2026-01-22 16:46:43,614] [INFO]: Top 15 Screener Symbols: LCID, TMDX, RACE, IAG, CGON, MMYT, MIDD, IBKR, QGEN, ALKS, SARO, KRC, WLK, MKSI, FIS
[2026-01-22 16:46:43,617] [INFO]: Top Candidates: symbol    score  win_rate      net_pnl
  LCID 0.882540 64.285714  9402.378350
  TMDX 0.752847 53.741497  6018.692700
  RACE 0.462952 49.275362  1514.194079
   IAG 0.455637 46.683047  -529.585732
  CGON 0.386494 50.847458   669.903529
  MMYT 0.356828 46.232877 -1641.843543
  MIDD 0.334309 40.566038  -347.164357
  IBKR 0.325267 41.131105 -2903.173986
  QGEN 0.310656 40.540541  -601.766645
  ALKS 0.301069 39.297125 -2241.903429
  SARO 0.289753 44.444444     9.313764
   KRC 0.260317 39.215686 -1191.237398
   WLK 0.255373 38.783270 -2679.600085
  MKSI 0.248714 37.759336 -2391.919971
   FIS 0.208537 38.400000 -1837.560824
[2026-01-22 16:46:43,622] [INFO]: Calculated Metrics: Trades=2, Net PnL=74.69, Win Rate=50.00%, Expectancy=37.34, Profit Factor=29.837780235945516, Max Drawdown=-2.59, Sharpe=1.31, Sortino=0.00
[2026-01-22 16:46:43,639] [INFO]: [DEBUG] Writing top candidates to DB: 15 rows
[2026-01-22 16:46:43,673] [INFO]: [INFO] TOP_CANDIDATES_REPLACED run_date=2026-01-21 deleted=15
[2026-01-22 16:46:43,679] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=15
[2026-01-22 16:46:43,692] [WARNING]: [WARN] DB_SCHEMA_FAILED view=latest_top_candidates err=must be owner of view latest_top_candidates

[2026-01-22 16:46:43,692] [INFO]: [INFO] DB_TOP_CANDIDATES rows=15
[2026-01-22 16:46:43,693] [INFO]: [INFO] DB write to top_candidates completed successfully
[2026-01-22 16:46:43,693] [INFO]: [DEBUG] Writing summary metrics to DB: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-22 16:46:43,708] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
[2026-01-22 16:46:43,709] [INFO]: [INFO] METRICS_DB_OK run_date=2026-01-21 total_trades=2 net_pnl=74.68999500000062
[2026-01-22 16:46:43,709] [INFO]: [INFO] DB write to metrics_daily completed successfully
[2026-01-22 16:46:43,724] [INFO]: Metrics calculation complete
[2026-01-22 16:46:43,724] [INFO]: Script finished in 0:00:00.166524
[2026-01-22T16:46:43.829891+00:00] END metrics rc=0 secs=1.6
[2026-01-22T16:55:43.347568+00:00] START metrics
[2026-01-22 16:55:44,394] [INFO]: Metrics script started
[2026-01-22 16:55:44,394] [INFO]: Starting metrics calculation
[2026-01-22 16:55:44,410] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-21 source=cli
[2026-01-22 16:55:44,436] [INFO]: [DEBUG] Ranked candidates dataframe shape: (15, 17)
[2026-01-22 16:55:44,437] [INFO]: [DEBUG] Ranked candidates columns: ['run_date', 'symbol', 'trades', 'win_rate', 'net_pnl', 'expectancy', 'profit_factor', 'max_drawdown', 'sharpe', 'sortino', 'created_at', 'avg_return', 'win_rate_norm', 'net_pnl_norm', 'trades_norm', 'avg_return_norm', 'score']
[2026-01-22 16:55:44,437] [INFO]: Screener Metrics Summary: total_candidates=15, avg_score=0.39
[2026-01-22 16:55:44,437] [INFO]: Top 15 Screener Symbols: LCID, TMDX, RACE, IAG, CGON, MMYT, MIDD, IBKR, QGEN, ALKS, SARO, KRC, WLK, MKSI, FIS
[2026-01-22 16:55:44,441] [INFO]: Top Candidates: symbol    score  win_rate      net_pnl
  LCID 0.882540 64.285714  9402.378350
  TMDX 0.752847 53.741497  6018.692700
  RACE 0.462952 49.275362  1514.194079
   IAG 0.455637 46.683047  -529.585732
  CGON 0.386494 50.847458   669.903529
  MMYT 0.356828 46.232877 -1641.843543
  MIDD 0.334309 40.566038  -347.164357
  IBKR 0.325267 41.131105 -2903.173986
  QGEN 0.310656 40.540541  -601.766645
  ALKS 0.301069 39.297125 -2241.903429
  SARO 0.289753 44.444444     9.313764
   KRC 0.260317 39.215686 -1191.237398
   WLK 0.255373 38.783270 -2679.600085
  MKSI 0.248714 37.759336 -2391.919971
   FIS 0.208537 38.400000 -1837.560824
[2026-01-22 16:55:44,445] [INFO]: Calculated Metrics: Trades=2, Net PnL=74.69, Win Rate=50.00%, Expectancy=37.34, Profit Factor=29.837780235945516, Max Drawdown=-2.59, Sharpe=1.31, Sortino=0.00
[2026-01-22 16:55:44,464] [INFO]: [DEBUG] Writing top candidates to DB: 15 rows
[2026-01-22 16:55:44,494] [INFO]: [INFO] TOP_CANDIDATES_REPLACED run_date=2026-01-21 deleted=15
[2026-01-22 16:55:44,506] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=15
[2026-01-22 16:55:44,519] [WARNING]: [WARN] DB_SCHEMA_FAILED view=latest_top_candidates err=must be owner of view latest_top_candidates

[2026-01-22 16:55:44,519] [INFO]: [INFO] DB_TOP_CANDIDATES rows=15
[2026-01-22 16:55:44,519] [INFO]: [INFO] DB write to top_candidates completed successfully
[2026-01-22 16:55:44,519] [INFO]: [DEBUG] Writing summary metrics to DB: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-22 16:55:44,533] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
[2026-01-22 16:55:44,534] [INFO]: [INFO] METRICS_DB_OK run_date=2026-01-21 total_trades=2 net_pnl=74.68999500000062
[2026-01-22 16:55:44,534] [INFO]: [INFO] DB write to metrics_daily completed successfully
[2026-01-22 16:55:44,546] [INFO]: Metrics calculation complete
[2026-01-22 16:55:44,546] [INFO]: Script finished in 0:00:00.152280
[2026-01-22T16:55:44.675334+00:00] END metrics rc=0 secs=1.3
[2026-01-22T17:24:52.117634+00:00] START metrics
[2026-01-22 17:24:53,387] [INFO]: Metrics script started
[2026-01-22 17:24:53,387] [INFO]: Starting metrics calculation
[2026-01-22 17:24:53,404] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-21 source=cli
[2026-01-22 17:24:53,436] [INFO]: [DEBUG] Ranked candidates dataframe shape: (15, 17)
[2026-01-22 17:24:53,436] [INFO]: [DEBUG] Ranked candidates columns: ['run_date', 'symbol', 'trades', 'win_rate', 'net_pnl', 'expectancy', 'profit_factor', 'max_drawdown', 'sharpe', 'sortino', 'created_at', 'avg_return', 'win_rate_norm', 'net_pnl_norm', 'trades_norm', 'avg_return_norm', 'score']
[2026-01-22 17:24:53,436] [INFO]: Screener Metrics Summary: total_candidates=15, avg_score=0.39
[2026-01-22 17:24:53,436] [INFO]: Top 15 Screener Symbols: LCID, TMDX, RACE, IAG, CGON, MMYT, MIDD, IBKR, QGEN, ALKS, SARO, WLK, KRC, MKSI, FIS
[2026-01-22 17:24:53,441] [INFO]: Top Candidates: symbol    score  win_rate      net_pnl
  LCID 0.882540 64.285714  9378.233814
  TMDX 0.754394 53.741497  6045.759907
  RACE 0.463872 49.282297  1512.840764
   IAG 0.455560 46.683047  -530.302525
  CGON 0.386775 50.847458   672.508179
  MMYT 0.352923 45.890411 -1683.541107
  MIDD 0.330848 40.284360  -376.387743
  IBKR 0.325294 41.131105 -2894.982900
  QGEN 0.310408 40.540541  -606.043931
  ALKS 0.300811 39.297125 -2242.901821
  SARO 0.289830 44.444444    10.033029
   WLK 0.255759 38.783270 -2662.908928
   KRC 0.251149 38.562092 -1302.360240
  MKSI 0.245276 37.603306 -2460.764464
   FIS 0.206194 38.211382 -1828.637400
[2026-01-22 17:24:53,447] [INFO]: Calculated Metrics: Trades=2, Net PnL=74.69, Win Rate=50.00%, Expectancy=37.34, Profit Factor=29.837780235945516, Max Drawdown=-2.59, Sharpe=1.31, Sortino=0.00
[2026-01-22 17:24:53,467] [INFO]: [DEBUG] Writing top candidates to DB: 15 rows
[2026-01-22 17:24:53,497] [INFO]: [INFO] TOP_CANDIDATES_REPLACED run_date=2026-01-21 deleted=15
[2026-01-22 17:24:53,503] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=15
[2026-01-22 17:24:53,515] [WARNING]: [WARN] DB_SCHEMA_FAILED view=latest_top_candidates err=must be owner of view latest_top_candidates

[2026-01-22 17:24:53,515] [INFO]: [INFO] DB_TOP_CANDIDATES rows=15
[2026-01-22 17:24:53,516] [INFO]: [INFO] DB write to top_candidates completed successfully
[2026-01-22 17:24:53,516] [INFO]: [DEBUG] Writing summary metrics to DB: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-22 17:24:53,530] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
[2026-01-22 17:24:53,530] [INFO]: [INFO] METRICS_DB_OK run_date=2026-01-21 total_trades=2 net_pnl=74.68999500000062
[2026-01-22 17:24:53,530] [INFO]: [INFO] DB write to metrics_daily completed successfully
[2026-01-22 17:24:53,544] [INFO]: Metrics calculation complete
[2026-01-22 17:24:53,544] [INFO]: Script finished in 0:00:00.157313
[2026-01-22T17:24:53.744251+00:00] END metrics rc=0 secs=1.6
[2026-01-22T17:27:05.996766+00:00] START metrics
[2026-01-22 17:27:07,416] [INFO]: Metrics script started
[2026-01-22 17:27:07,416] [INFO]: Starting metrics calculation
[2026-01-22 17:27:07,435] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-21 source=cli
[2026-01-22 17:27:07,467] [INFO]: [DEBUG] Ranked candidates dataframe shape: (15, 17)
[2026-01-22 17:27:07,467] [INFO]: [DEBUG] Ranked candidates columns: ['run_date', 'symbol', 'trades', 'win_rate', 'net_pnl', 'expectancy', 'profit_factor', 'max_drawdown', 'sharpe', 'sortino', 'created_at', 'avg_return', 'win_rate_norm', 'net_pnl_norm', 'trades_norm', 'avg_return_norm', 'score']
[2026-01-22 17:27:07,467] [INFO]: Screener Metrics Summary: total_candidates=15, avg_score=0.39
[2026-01-22 17:27:07,468] [INFO]: Top 15 Screener Symbols: LCID, TMDX, RACE, IAG, CGON, MMYT, MIDD, IBKR, QGEN, ALKS, SARO, KRC, WLK, MKSI, FIS
[2026-01-22 17:27:07,473] [INFO]: Top Candidates: symbol    score  win_rate      net_pnl
  LCID 0.882540 64.285714  9402.378350
  TMDX 0.752847 53.741497  6018.692700
  RACE 0.462952 49.275362  1514.194079
   IAG 0.455637 46.683047  -529.585732
  CGON 0.386494 50.847458   669.903529
  MMYT 0.356828 46.232877 -1641.843543
  MIDD 0.334309 40.566038  -347.164357
  IBKR 0.325267 41.131105 -2903.173986
  QGEN 0.310656 40.540541  -601.766645
  ALKS 0.301069 39.297125 -2241.903429
  SARO 0.289753 44.444444     9.313764
   KRC 0.260317 39.215686 -1191.237398
   WLK 0.255373 38.783270 -2679.600085
  MKSI 0.248714 37.759336 -2391.919971
   FIS 0.208537 38.400000 -1837.560824
[2026-01-22 17:27:07,478] [INFO]: Calculated Metrics: Trades=2, Net PnL=74.69, Win Rate=50.00%, Expectancy=37.34, Profit Factor=29.837780235945516, Max Drawdown=-2.59, Sharpe=1.31, Sortino=0.00
[2026-01-22 17:27:07,498] [INFO]: [DEBUG] Writing top candidates to DB: 15 rows
[2026-01-22 17:27:07,529] [INFO]: [INFO] TOP_CANDIDATES_REPLACED run_date=2026-01-21 deleted=15
[2026-01-22 17:27:07,536] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=15
[2026-01-22 17:27:07,549] [WARNING]: [WARN] DB_SCHEMA_FAILED view=latest_top_candidates err=must be owner of view latest_top_candidates

[2026-01-22 17:27:07,550] [INFO]: [INFO] DB_TOP_CANDIDATES rows=15
[2026-01-22 17:27:07,550] [INFO]: [INFO] DB write to top_candidates completed successfully
[2026-01-22 17:27:07,550] [INFO]: [DEBUG] Writing summary metrics to DB: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-22 17:27:07,565] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
[2026-01-22 17:27:07,565] [INFO]: [INFO] METRICS_DB_OK run_date=2026-01-21 total_trades=2 net_pnl=74.68999500000062
[2026-01-22 17:27:07,565] [INFO]: [INFO] DB write to metrics_daily completed successfully
[2026-01-22 17:27:07,581] [INFO]: Metrics calculation complete
[2026-01-22 17:27:07,582] [INFO]: Script finished in 0:00:00.165879
[2026-01-22T17:27:07.775082+00:00] END metrics rc=0 secs=1.8
[2026-01-22T18:34:04.083695+00:00] START metrics
[2026-01-22 18:34:05,495] [INFO]: Metrics script started
[2026-01-22 18:34:05,496] [INFO]: Starting metrics calculation
[2026-01-22 18:34:05,514] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-21 source=cli
[2026-01-22 18:34:05,552] [INFO]: [DEBUG] screener_candidates shape: (15, 6)
[2026-01-22 18:34:05,552] [INFO]: [DEBUG] backtest_results shape: (15, 11)
[2026-01-22 18:34:05,569] [INFO]: [DEBUG] Ranked DataFrame shape: (15, 17)
[2026-01-22 18:34:05,569] [INFO]: [DEBUG] Ranked DataFrame columns: ['run_date', 'symbol', 'trades', 'win_rate', 'net_pnl', 'expectancy', 'profit_factor', 'max_drawdown', 'sharpe', 'sortino', 'created_at', 'avg_return', 'win_rate_norm', 'net_pnl_norm', 'trades_norm', 'avg_return_norm', 'score']
[2026-01-22 18:34:05,570] [INFO]: Screener Metrics Summary: total_candidates=15, avg_score=0.39
[2026-01-22 18:34:05,570] [INFO]: Top 15 Screener Symbols: LCID, TMDX, RACE, IAG, CGON, MMYT, MIDD, IBKR, QGEN, ALKS, SARO, KRC, WLK, MKSI, FIS
[2026-01-22 18:34:05,577] [INFO]: Top Candidates: symbol    score  win_rate      net_pnl
  LCID 0.882540 64.285714  9402.378350
  TMDX 0.752847 53.741497  6018.692700
  RACE 0.462952 49.275362  1514.194079
   IAG 0.455637 46.683047  -529.585732
  CGON 0.386494 50.847458   669.903529
  MMYT 0.356828 46.232877 -1641.843543
  MIDD 0.334309 40.566038  -347.164357
  IBKR 0.325267 41.131105 -2903.173986
  QGEN 0.310656 40.540541  -601.766645
  ALKS 0.301069 39.297125 -2241.903429
  SARO 0.289753 44.444444     9.313764
   KRC 0.260317 39.215686 -1191.237398
   WLK 0.255373 38.783270 -2679.600085
  MKSI 0.248714 37.759336 -2391.919971
   FIS 0.208537 38.400000 -1837.560824
[2026-01-22 18:34:05,584] [INFO]: Calculated Metrics: Trades=2, Net PnL=74.69, Win Rate=50.00%, Expectancy=37.34, Profit Factor=29.837780235945516, Max Drawdown=-2.59, Sharpe=1.31, Sortino=0.00
[2026-01-22 18:34:05,589] [INFO]: [INFO] Writing 15 top candidates to DB
[2026-01-22 18:34:05,623] [INFO]: [INFO] TOP_CANDIDATES_REPLACED run_date=2026-01-21 deleted=15
[2026-01-22 18:34:05,631] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=15
[2026-01-22 18:34:05,646] [WARNING]: [WARN] DB_SCHEMA_FAILED view=latest_top_candidates err=must be owner of view latest_top_candidates

[2026-01-22 18:34:05,646] [INFO]: [INFO] DB_TOP_CANDIDATES rows=15
[2026-01-22 18:34:05,646] [INFO]: [INFO] DB write to top_candidates completed successfully
[2026-01-22 18:34:05,647] [INFO]: [INFO] Summary metrics prepared: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-22 18:34:05,661] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
[2026-01-22 18:34:05,661] [INFO]: [INFO] METRICS_DB_OK run_date=2026-01-21 total_trades=2 net_pnl=74.68999500000062
[2026-01-22 18:34:05,661] [INFO]: [INFO] DB write to metrics_daily complete
[2026-01-22 18:34:05,677] [INFO]: Metrics calculation complete
[2026-01-22 18:34:05,677] [INFO]: Script finished in 0:00:00.181223
[2026-01-22T18:34:05.816280+00:00] END metrics rc=0 secs=1.7
[2026-01-22T18:34:07.642605+00:00] START metrics
[2026-01-22 18:34:08,716] [INFO]: Metrics script started
[2026-01-22 18:34:08,716] [INFO]: Starting metrics calculation
[2026-01-22 18:34:08,732] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-21 source=cli
[2026-01-22 18:34:08,760] [INFO]: [DEBUG] screener_candidates shape: (15, 6)
[2026-01-22 18:34:08,760] [INFO]: [DEBUG] backtest_results shape: (15, 11)
[2026-01-22 18:34:08,772] [INFO]: [DEBUG] Ranked DataFrame shape: (15, 17)
[2026-01-22 18:34:08,772] [INFO]: [DEBUG] Ranked DataFrame columns: ['run_date', 'symbol', 'trades', 'win_rate', 'net_pnl', 'expectancy', 'profit_factor', 'max_drawdown', 'sharpe', 'sortino', 'created_at', 'avg_return', 'win_rate_norm', 'net_pnl_norm', 'trades_norm', 'avg_return_norm', 'score']
[2026-01-22 18:34:08,773] [INFO]: Screener Metrics Summary: total_candidates=15, avg_score=0.39
[2026-01-22 18:34:08,773] [INFO]: Top 15 Screener Symbols: LCID, TMDX, RACE, IAG, CGON, MMYT, MIDD, IBKR, QGEN, ALKS, SARO, KRC, WLK, MKSI, FIS
[2026-01-22 18:34:08,776] [INFO]: Top Candidates: symbol    score  win_rate      net_pnl
  LCID 0.882540 64.285714  9402.378350
  TMDX 0.752847 53.741497  6018.692700
  RACE 0.462952 49.275362  1514.194079
   IAG 0.455637 46.683047  -529.585732
  CGON 0.386494 50.847458   669.903529
  MMYT 0.356828 46.232877 -1641.843543
  MIDD 0.334309 40.566038  -347.164357
  IBKR 0.325267 41.131105 -2903.173986
  QGEN 0.310656 40.540541  -601.766645
  ALKS 0.301069 39.297125 -2241.903429
  SARO 0.289753 44.444444     9.313764
   KRC 0.260317 39.215686 -1191.237398
   WLK 0.255373 38.783270 -2679.600085
  MKSI 0.248714 37.759336 -2391.919971
   FIS 0.208537 38.400000 -1837.560824
[2026-01-22 18:34:08,781] [INFO]: Calculated Metrics: Trades=2, Net PnL=74.69, Win Rate=50.00%, Expectancy=37.34, Profit Factor=29.837780235945516, Max Drawdown=-2.59, Sharpe=1.31, Sortino=0.00
[2026-01-22 18:34:08,784] [INFO]: [INFO] Writing 15 top candidates to DB
[2026-01-22 18:34:08,809] [INFO]: [INFO] TOP_CANDIDATES_REPLACED run_date=2026-01-21 deleted=15
[2026-01-22 18:34:08,815] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=15
[2026-01-22 18:34:08,826] [WARNING]: [WARN] DB_SCHEMA_FAILED view=latest_top_candidates err=must be owner of view latest_top_candidates

[2026-01-22 18:34:08,826] [INFO]: [INFO] DB_TOP_CANDIDATES rows=15
[2026-01-22 18:34:08,826] [INFO]: [INFO] DB write to top_candidates completed successfully
[2026-01-22 18:34:08,826] [INFO]: [INFO] Summary metrics prepared: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-22 18:34:08,839] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
[2026-01-22 18:34:08,840] [INFO]: [INFO] METRICS_DB_OK run_date=2026-01-21 total_trades=2 net_pnl=74.68999500000062
[2026-01-22 18:34:08,840] [INFO]: [INFO] DB write to metrics_daily complete
[2026-01-22 18:34:08,872] [INFO]: Metrics calculation complete
[2026-01-22 18:34:08,872] [INFO]: Script finished in 0:00:00.155958
[2026-01-22T18:34:09.023438+00:00] END metrics rc=0 secs=1.4
[2026-01-22T19:26:16.757049+00:00] START metrics
[2026-01-22 19:26:18,115] [INFO]: Metrics script started
/home/RasPatrick/jbravo_screener/scripts/metrics.py:57: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  start_time = datetime.utcnow()
[2026-01-22 19:26:18,117] [INFO]: Starting metrics calculation
[2026-01-22 19:26:18,136] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-21 source=cli
[2026-01-22 19:26:18,172] [INFO]: [DEBUG] screener_candidates shape: (15, 6)
[2026-01-22 19:26:18,172] [INFO]: [DEBUG] backtest_results shape: (15, 11)
[2026-01-22 19:26:18,180] [INFO]: [DEBUG] Starting rank_and_filter_candidates with 15 candidates
[2026-01-22 19:26:18,188] [INFO]: [DEBUG] ranked_df shape: (15, 17)
[2026-01-22 19:26:18,188] [INFO]: [DEBUG] Ranked DataFrame columns: ['run_date', 'symbol', 'trades', 'win_rate', 'net_pnl', 'expectancy', 'profit_factor', 'max_drawdown', 'sharpe', 'sortino', 'created_at', 'avg_return', 'win_rate_norm', 'net_pnl_norm', 'trades_norm', 'avg_return_norm', 'score']
[2026-01-22 19:26:18,188] [INFO]: Screener Metrics Summary: total_candidates=15, avg_score=0.39
[2026-01-22 19:26:18,189] [INFO]: Top 15 Screener Symbols: LCID, TMDX, RACE, IAG, CGON, MMYT, MIDD, IBKR, QGEN, ALKS, SARO, WLK, KRC, MKSI, FIS
[2026-01-22 19:26:18,196] [INFO]: Top Candidates: symbol    score  win_rate      net_pnl
  LCID 0.882540 64.285714  9378.233814
  TMDX 0.754394 53.741497  6045.759907
  RACE 0.463872 49.282297  1512.840764
   IAG 0.455560 46.683047  -530.302525
  CGON 0.386775 50.847458   672.508179
  MMYT 0.352923 45.890411 -1683.541107
  MIDD 0.330848 40.284360  -376.387743
  IBKR 0.325294 41.131105 -2894.982900
  QGEN 0.310408 40.540541  -606.043931
  ALKS 0.300811 39.297125 -2242.901821
  SARO 0.289830 44.444444    10.033029
   WLK 0.255759 38.783270 -2662.908928
   KRC 0.251149 38.562092 -1302.360240
  MKSI 0.245276 37.603306 -2460.764464
   FIS 0.206194 38.211382 -1828.637400
[2026-01-22 19:26:18,202] [INFO]: Calculated Metrics: Trades=2, Net PnL=74.69, Win Rate=50.00%, Expectancy=37.34, Profit Factor=29.837780235945516, Max Drawdown=-2.59, Sharpe=1.31, Sortino=0.00
[2026-01-22 19:26:18,207] [INFO]: [INFO] Writing 15 top candidates to DB
[2026-01-22 19:26:18,238] [INFO]: [INFO] TOP_CANDIDATES_REPLACED run_date=2026-01-21 deleted=15
[2026-01-22 19:26:18,245] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=15
[2026-01-22 19:26:18,262] [WARNING]: [WARN] DB_SCHEMA_FAILED view=latest_top_candidates err=must be owner of view latest_top_candidates

[2026-01-22 19:26:18,263] [INFO]: [INFO] DB write to top_candidates completed
[2026-01-22 19:26:18,263] [INFO]: [INFO] Summary metrics prepared: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-22 19:26:18,282] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
[2026-01-22 19:26:18,282] [INFO]: [INFO] DB write to metrics_daily completed
[2026-01-22 19:26:18,299] [INFO]: Metrics calculation complete
/home/RasPatrick/jbravo_screener/scripts/metrics.py:604: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  end_time = datetime.utcnow()
[2026-01-22 19:26:18,299] [INFO]: Script finished in 0:00:00.182921
[2026-01-22T19:26:18.433363+00:00] END metrics rc=0 secs=1.7
[2026-01-22T20:42:24.376053+00:00] START metrics
[2026-01-22 20:42:25,573] [INFO]: Metrics script started
[2026-01-22 20:42:25,573] [INFO]: Starting metrics calculation
[2026-01-22 20:42:25,573] [INFO]:  [METRICS] main() start
[2026-01-22 20:42:25,589] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-21 source=cli
[2026-01-22 20:42:25,620] [INFO]:  [METRICS] screener_df rows: 15
[2026-01-22 20:42:25,620] [INFO]:  [METRICS] backtest_df rows: 15
[2026-01-22 20:42:25,626] [INFO]:  [METRICS] Starting candidate ranking
[2026-01-22 20:42:25,635] [INFO]:  [METRICS] ranked_df rows: 15
[2026-01-22 20:42:25,635] [INFO]: [DEBUG] ranked_df shape: (15, 22)
[2026-01-22 20:42:25,635] [INFO]: [DEBUG] Ranked DataFrame columns: ['run_date', 'symbol', 'trades', 'win_rate', 'net_pnl', 'expectancy', 'profit_factor', 'max_drawdown', 'sharpe', 'sortino', 'created_at', 'avg_return', 'win_rate_norm', 'net_pnl_norm', 'trades_norm', 'avg_return_norm', 'score', 'entry_price', 'adv20', 'atrp', 'exchange', 'source']
[2026-01-22 20:42:25,635] [INFO]: Screener Metrics Summary: total_candidates=15, avg_score=0.39
[2026-01-22 20:42:25,635] [INFO]: Top 15 Screener Symbols: LCID, TMDX, RACE, IAG, CGON, MMYT, MIDD, IBKR, QGEN, ALKS, SARO, KRC, WLK, MKSI, FIS
[2026-01-22 20:42:25,640] [INFO]: Top Candidates: symbol    score  win_rate      net_pnl
  LCID 0.882540 64.285714  9402.378350
  TMDX 0.752847 53.741497  6018.692700
  RACE 0.462952 49.275362  1514.194079
   IAG 0.455637 46.683047  -529.585732
  CGON 0.386494 50.847458   669.903529
  MMYT 0.356828 46.232877 -1641.843543
  MIDD 0.334309 40.566038  -347.164357
  IBKR 0.325267 41.131105 -2903.173986
  QGEN 0.310656 40.540541  -601.766645
  ALKS 0.301069 39.297125 -2241.903429
  SARO 0.289753 44.444444     9.313764
   KRC 0.260317 39.215686 -1191.237398
   WLK 0.255373 38.783270 -2679.600085
  MKSI 0.248714 37.759336 -2391.919971
   FIS 0.208537 38.400000 -1837.560824
[2026-01-22 20:42:25,640] [INFO]:  [METRICS] Writing to top_candidates DB
[2026-01-22 20:42:25,666] [INFO]: [INFO] TOP_CANDIDATES_REPLACED run_date=2026-01-21 deleted=15
[2026-01-22 20:42:25,672] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=15
[2026-01-22 20:42:25,684] [WARNING]: [WARN] DB_SCHEMA_FAILED view=latest_top_candidates err=must be owner of view latest_top_candidates

[2026-01-22 20:42:25,684] [INFO]:  [METRICS] top_candidates DB write complete
[2026-01-22 20:42:25,689] [INFO]: Calculated Metrics: Trades=2, Net PnL=74.69, Win Rate=50.00%, Expectancy=37.34, Profit Factor=29.837780235945516, Max Drawdown=-2.59, Sharpe=1.31, Sortino=0.00
[2026-01-22 20:42:25,689] [INFO]:  [METRICS] summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-22 20:42:25,701] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
[2026-01-22 20:42:25,701] [INFO]:  [METRICS] metrics_daily DB write complete
[2026-01-22 20:42:25,715] [INFO]:  [METRICS] main() complete
[2026-01-22 20:42:25,715] [INFO]: [INFO] metrics.py completed successfully
[2026-01-22 20:42:25,716] [INFO]: Metrics calculation complete
[2026-01-22 20:42:25,716] [INFO]: Script finished in 0:00:00.142799
[2026-01-22T20:42:25.853958+00:00] END metrics rc=0 secs=1.5
[2026-01-22T21:01:20.781302+00:00] START metrics
[2026-01-22 21:01:21,831] [INFO]: Metrics script started
[2026-01-22 21:01:21,831] [INFO]: Starting metrics calculation
>>> METRICS MAIN ENTERED <<<
[2026-01-22 21:01:21,831] [INFO]: >>> METRICS MAIN ENTERED <<<
[2026-01-22 21:01:21,831] [INFO]:  [METRICS] main() start
[2026-01-22 21:01:21,849] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-22 source=cli
>>> screener_df rows: 0
[2026-01-22 21:01:21,881] [INFO]: >>> screener_df rows: 0
>>> backtest_df rows: 0
[2026-01-22 21:01:21,881] [INFO]: >>> backtest_df rows: 0
>>> Starting rank_and_filter_candidates()
[2026-01-22 21:01:21,888] [INFO]: >>> Starting rank_and_filter_candidates()
[2026-01-22 21:01:21,888] [INFO]:  [METRICS] Starting candidate ranking
>>> ranked_df is empty  skipping DB writes
[2026-01-22 21:01:21,894] [WARNING]: >>> ranked_df is empty  skipping DB writes
>>> ranked_df is empty  skipping DB writes
[2026-01-22 21:01:21,894] [WARNING]: >>> ranked_df is empty  skipping DB writes
[2026-01-22 21:01:21,900] [INFO]: Calculated Metrics: Trades=2, Net PnL=74.69, Win Rate=50.00%, Expectancy=37.34, Profit Factor=29.837780235945516, Max Drawdown=-2.59, Sharpe=1.31, Sortino=0.00
>>> summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-22 21:01:21,900] [INFO]: >>> summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-22 21:01:21,900] [INFO]:  [METRICS] summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-22 21:01:21,914] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
>>> metrics_daily write complete
[2026-01-22 21:01:21,914] [INFO]: >>> metrics_daily write complete
[2026-01-22 21:01:21,914] [INFO]:  [METRICS] metrics_daily DB write complete
>>> METRICS MAIN COMPLETED <<<
[2026-01-22 21:01:21,944] [INFO]: >>> METRICS MAIN COMPLETED <<<
[2026-01-22 21:01:21,945] [INFO]:  [METRICS] main() complete
[2026-01-22 21:01:21,945] [INFO]: [INFO] metrics.py completed successfully
[2026-01-22 21:01:21,945] [INFO]: Metrics calculation complete
[2026-01-22 21:01:21,945] [INFO]: Script finished in 0:00:00.113513
[2026-01-22T21:01:22.108276+00:00] END metrics rc=0 secs=1.3
[2026-01-22T21:37:31.844838+00:00] START metrics
[2026-01-22 21:37:32,927] [INFO]: Metrics script started
[2026-01-22 21:37:32,927] [INFO]: Starting metrics calculation
>>> METRICS MAIN ENTERED <<<
[2026-01-22 21:37:32,927] [INFO]: >>> METRICS MAIN ENTERED <<<
[2026-01-22 21:37:32,927] [INFO]:  [METRICS] main() start
[2026-01-22 21:37:32,946] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-22 source=cli
>>> screener_df rows: 0
[2026-01-22 21:37:32,980] [INFO]: >>> screener_df rows: 0
>>> backtest_df rows: 0
[2026-01-22 21:37:32,981] [INFO]: >>> backtest_df rows: 0
>>> Starting rank_and_filter_candidates()
[2026-01-22 21:37:32,988] [INFO]: >>> Starting rank_and_filter_candidates()
[2026-01-22 21:37:32,988] [INFO]:  [METRICS] Starting candidate ranking
>>> ranked_df is empty  skipping DB writes
[2026-01-22 21:37:32,993] [WARNING]: >>> ranked_df is empty  skipping DB writes
>>> ranked_df is empty  skipping DB writes
[2026-01-22 21:37:32,993] [WARNING]: >>> ranked_df is empty  skipping DB writes
[2026-01-22 21:37:32,998] [INFO]: Calculated Metrics: Trades=2, Net PnL=74.69, Win Rate=50.00%, Expectancy=37.34, Profit Factor=29.837780235945516, Max Drawdown=-2.59, Sharpe=1.31, Sortino=0.00
>>> summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-22 21:37:32,998] [INFO]: >>> summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-22 21:37:32,998] [INFO]:  [METRICS] summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-22 21:37:33,011] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
>>> metrics_daily write complete
[2026-01-22 21:37:33,012] [INFO]: >>> metrics_daily write complete
[2026-01-22 21:37:33,012] [INFO]:  [METRICS] metrics_daily DB write complete
>>> METRICS MAIN COMPLETED <<<
[2026-01-22 21:37:33,024] [INFO]: >>> METRICS MAIN COMPLETED <<<
[2026-01-22 21:37:33,024] [INFO]:  [METRICS] main() complete
[2026-01-22 21:37:33,024] [INFO]: [INFO] metrics.py completed successfully
[2026-01-22 21:37:33,024] [INFO]: Metrics calculation complete
[2026-01-22 21:37:33,024] [INFO]: Script finished in 0:00:00.097482
[2026-01-22T21:37:33.171539+00:00] END metrics rc=0 secs=1.3
[2026-01-22T21:43:46.270110+00:00] START metrics
[2026-01-22 21:43:47,254] [INFO]: Metrics script started
>>> METRICS MAIN ENTERED <<<
[2026-01-22 21:43:47,254] [INFO]: >>> METRICS MAIN ENTERED <<<
[2026-01-22 21:43:47,254] [INFO]:  [METRICS] main() start
[2026-01-22 21:43:47,272] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-22 source=cli
>>> screener_df rows: 0
[2026-01-22 21:43:47,302] [INFO]: >>> screener_df rows: 0
>>> backtest_df rows: 0
[2026-01-22 21:43:47,302] [INFO]: >>> backtest_df rows: 0
>>> Starting rank_and_filter_candidates()
[2026-01-22 21:43:47,309] [INFO]: >>> Starting rank_and_filter_candidates()
[2026-01-22 21:43:47,309] [INFO]:  [METRICS] Starting candidate ranking
>>> ranked_df is empty  skipping DB writes
[2026-01-22 21:43:47,313] [WARNING]: >>> ranked_df is empty  skipping DB writes
>>> ranked_df is empty  skipping DB writes
[2026-01-22 21:43:47,314] [WARNING]: >>> ranked_df is empty  skipping DB writes
[2026-01-22 21:43:47,318] [INFO]: Calculated Metrics: Trades=2, Net PnL=74.69, Win Rate=50.00%, Expectancy=37.34, Profit Factor=29.837780235945516, Max Drawdown=-2.59, Sharpe=1.31, Sortino=0.00
>>> summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-22 21:43:47,318] [INFO]: >>> summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-22 21:43:47,318] [INFO]:  [METRICS] summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-22 21:43:47,335] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
>>> metrics_daily write complete
[2026-01-22 21:43:47,335] [INFO]: >>> metrics_daily write complete
[2026-01-22 21:43:47,335] [INFO]:  [METRICS] metrics_daily DB write complete
>>> METRICS MAIN COMPLETED <<<
[2026-01-22 21:43:47,350] [INFO]: >>> METRICS MAIN COMPLETED <<<
[2026-01-22 21:43:47,350] [INFO]:  [METRICS] main() complete
[2026-01-22 21:43:47,350] [INFO]: [INFO] metrics.py completed successfully
[2026-01-22T21:43:47.496497+00:00] END metrics rc=0 secs=1.2
[2026-01-22T22:12:08.261499+00:00] START metrics
>>> METRICS FILE EXECUTED <<<
[2026-01-22 22:12:09,290] [INFO]: Metrics script started
>>> METRICS MAIN ENTERED <<<
[2026-01-22 22:12:09,290] [INFO]: >>> METRICS MAIN ENTERED <<<
[2026-01-22 22:12:09,290] [INFO]:  [METRICS] main() start
[2026-01-22 22:12:09,307] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-22 source=cli
>>> Loaded screener_df and backtest_df
>>> screener_df rows: 0
[2026-01-22 22:12:09,335] [INFO]: >>> screener_df rows: 0
>>> backtest_df rows: 0
[2026-01-22 22:12:09,335] [INFO]: >>> backtest_df rows: 0
>>> Starting rank_and_filter_candidates
[2026-01-22 22:12:09,341] [INFO]: >>> Starting rank_and_filter_candidates()
[2026-01-22 22:12:09,341] [INFO]:  [METRICS] Starting candidate ranking
>>> ranked_df is empty  skipping DB writes
[2026-01-22 22:12:09,346] [WARNING]: >>> ranked_df is empty  skipping DB writes
>>> ranked_df is empty  skipping DB writes
[2026-01-22 22:12:09,346] [WARNING]: >>> ranked_df is empty  skipping DB writes
[2026-01-22 22:12:09,351] [INFO]: Calculated Metrics: Trades=2, Net PnL=74.69, Win Rate=50.00%, Expectancy=37.34, Profit Factor=29.837780235945516, Max Drawdown=-2.59, Sharpe=1.31, Sortino=0.00
>>> summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-22 22:12:09,351] [INFO]: >>> summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-22 22:12:09,351] [INFO]:  [METRICS] summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
>>> Writing to metrics_daily
[2026-01-22 22:12:09,365] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
>>> metrics_daily write complete
[2026-01-22 22:12:09,365] [INFO]: >>> metrics_daily write complete
[2026-01-22 22:12:09,366] [INFO]:  [METRICS] metrics_daily DB write complete
>>> METRICS COMPLETE <<<
[2026-01-22 22:12:09,378] [INFO]: >>> METRICS MAIN COMPLETED <<<
[2026-01-22 22:12:09,378] [INFO]:  [METRICS] main() complete
[2026-01-22 22:12:09,378] [INFO]: [INFO] metrics.py completed successfully
[2026-01-22T22:12:09.484311+00:00] END metrics rc=0 secs=1.2
[2026-01-23T01:52:08.521957+00:00] START metrics
>>> METRICS FILE EXECUTED <<<
[2026-01-23 01:52:09,789] [INFO]: Metrics script started
>>> METRICS MAIN ENTERED <<<
[2026-01-23 01:52:09,789] [INFO]: >>> METRICS MAIN ENTERED <<<
[2026-01-23 01:52:09,789] [INFO]:  [METRICS] main() start
[2026-01-23 01:52:09,808] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-22 source=cli
>>> Loaded screener_df and backtest_df
>>> screener_df rows: 8
[2026-01-23 01:52:09,839] [INFO]: >>> screener_df rows: 8
>>> backtest_df rows: 8
[2026-01-23 01:52:09,839] [INFO]: >>> backtest_df rows: 8
>>> Starting rank_and_filter_candidates
[2026-01-23 01:52:09,845] [INFO]: >>> Starting rank_and_filter_candidates()
[2026-01-23 01:52:09,845] [INFO]:  [METRICS] Starting candidate ranking
>>> ranked_df rows: 8
[2026-01-23 01:52:09,854] [INFO]: >>> ranked_df rows: 8
[2026-01-23 01:52:09,854] [INFO]:  [METRICS] ranked_df rows: 8
[2026-01-23 01:52:09,854] [INFO]: [DEBUG] ranked_df shape: (8, 22)
[2026-01-23 01:52:09,854] [INFO]: [DEBUG] Ranked DataFrame columns: ['run_date', 'symbol', 'trades', 'win_rate', 'net_pnl', 'expectancy', 'profit_factor', 'max_drawdown', 'sharpe', 'sortino', 'created_at', 'avg_return', 'win_rate_norm', 'net_pnl_norm', 'trades_norm', 'avg_return_norm', 'score', 'entry_price', 'adv20', 'atrp', 'exchange', 'source']
[2026-01-23 01:52:09,855] [INFO]: Screener Metrics Summary: total_candidates=8, avg_score=0.17
[2026-01-23 01:52:09,855] [INFO]: Top 15 Screener Symbols: UAL, LIF, LTH, FLUT, BANC, PCTY, HBAN, WY
[2026-01-23 01:52:09,859] [INFO]: Top Candidates: symbol     score  win_rate      net_pnl
   UAL  0.854234 47.317744  1368.185929
   LIF  0.830812 52.678571  1463.123467
   LTH  0.558829 45.348837   431.651543
  FLUT  0.197025 41.346154  -522.298736
  BANC  0.044947 41.885626 -2079.987019
  PCTY -0.219683 44.238683 -3121.934729
  HBAN -0.309597 40.036900 -3480.092605
    WY -0.561798 39.539347 -4575.352193
>>> Writing to top_candidates
[2026-01-23 01:52:09,859] [INFO]: >>> Writing to top_candidates
[2026-01-23 01:52:09,883] [INFO]: [INFO] TOP_CANDIDATES_REPLACED run_date=2026-01-22 deleted=0
[2026-01-23 01:52:09,888] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=8
[2026-01-23 01:52:09,899] [WARNING]: [WARN] DB_SCHEMA_FAILED view=latest_top_candidates err=must be owner of view latest_top_candidates

>>> top_candidates write complete
[2026-01-23 01:52:09,899] [INFO]: >>> top_candidates write complete
[2026-01-23 01:52:09,899] [INFO]:  [METRICS] top_candidates DB write complete
[2026-01-23 01:52:09,905] [INFO]: Calculated Metrics: Trades=2, Net PnL=74.69, Win Rate=50.00%, Expectancy=37.34, Profit Factor=29.837780235945516, Max Drawdown=-2.59, Sharpe=1.31, Sortino=0.00
>>> summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-23 01:52:09,905] [INFO]: >>> summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-23 01:52:09,905] [INFO]:  [METRICS] summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
>>> Writing to metrics_daily
[2026-01-23 01:52:09,916] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
>>> metrics_daily write complete
[2026-01-23 01:52:09,916] [INFO]: >>> metrics_daily write complete
[2026-01-23 01:52:09,916] [INFO]:  [METRICS] metrics_daily DB write complete
>>> METRICS COMPLETE <<<
[2026-01-23 01:52:09,928] [INFO]: >>> METRICS MAIN COMPLETED <<<
[2026-01-23 01:52:09,928] [INFO]:  [METRICS] main() complete
[2026-01-23 01:52:09,928] [INFO]: [INFO] metrics.py completed successfully
[2026-01-23T01:52:10.047899+00:00] END metrics rc=0 secs=1.5
[2026-01-23T02:37:00.887822+00:00] START metrics
>>> METRICS FILE EXECUTED <<<
[2026-01-23 02:37:02,232] [INFO]: Metrics script started
>>> METRICS MAIN ENTERED <<<
[2026-01-23 02:37:02,233] [INFO]: >>> METRICS MAIN ENTERED <<<
[2026-01-23 02:37:02,233] [INFO]:  [METRICS] main() start
[2026-01-23 02:37:02,253] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-22 source=cli
>>> Loaded screener_df and backtest_df
>>> screener_df rows: 8
[2026-01-23 02:37:02,284] [INFO]: >>> screener_df rows: 8
>>> backtest_df rows: 8
[2026-01-23 02:37:02,284] [INFO]: >>> backtest_df rows: 8
>>> Input data loaded  proceeding to ranking <<<
>>> Starting rank_and_filter_candidates
[2026-01-23 02:37:02,294] [INFO]: >>> Starting rank_and_filter_candidates()
[2026-01-23 02:37:02,294] [INFO]:  [METRICS] Starting candidate ranking
>>> ranked_df rows: 8
[2026-01-23 02:37:02,308] [INFO]: >>> ranked_df rows: 8
[2026-01-23 02:37:02,309] [INFO]:  [METRICS] ranked_df rows: 8
[2026-01-23 02:37:02,309] [INFO]: [DEBUG] ranked_df shape: (8, 22)
[2026-01-23 02:37:02,309] [INFO]: [DEBUG] Ranked DataFrame columns: ['run_date', 'symbol', 'trades', 'win_rate', 'net_pnl', 'expectancy', 'profit_factor', 'max_drawdown', 'sharpe', 'sortino', 'created_at', 'avg_return', 'win_rate_norm', 'net_pnl_norm', 'trades_norm', 'avg_return_norm', 'score', 'entry_price', 'adv20', 'atrp', 'exchange', 'source']
[2026-01-23 02:37:02,309] [INFO]: Screener Metrics Summary: total_candidates=8, avg_score=0.17
[2026-01-23 02:37:02,309] [INFO]: Top 15 Screener Symbols: UAL, LIF, LTH, FLUT, BANC, PCTY, HBAN, WY
[2026-01-23 02:37:02,314] [INFO]: Top Candidates: symbol     score  win_rate      net_pnl
   UAL  0.854234 47.317744  1368.185929
   LIF  0.830812 52.678571  1463.123467
   LTH  0.558829 45.348837   431.651543
  FLUT  0.197025 41.346154  -522.298736
  BANC  0.044947 41.885626 -2079.987019
  PCTY -0.219683 44.238683 -3121.934729
  HBAN -0.309597 40.036900 -3480.092605
    WY -0.561798 39.539347 -4575.352193
>>> Writing to top_candidates
[2026-01-23 02:37:02,314] [INFO]: >>> Writing to top_candidates
[2026-01-23 02:37:02,347] [INFO]: [INFO] TOP_CANDIDATES_REPLACED run_date=2026-01-22 deleted=8
[2026-01-23 02:37:02,355] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=8
[2026-01-23 02:37:02,370] [WARNING]: [WARN] DB_SCHEMA_FAILED view=latest_top_candidates err=must be owner of view latest_top_candidates

>>> top_candidates write complete
[2026-01-23 02:37:02,370] [INFO]: >>> top_candidates write complete
[2026-01-23 02:37:02,371] [INFO]:  [METRICS] top_candidates DB write complete
[2026-01-23 02:37:02,379] [INFO]: Calculated Metrics: Trades=2, Net PnL=74.69, Win Rate=50.00%, Expectancy=37.34, Profit Factor=29.837780235945516, Max Drawdown=-2.59, Sharpe=1.31, Sortino=0.00
>>> summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-23 02:37:02,379] [INFO]: >>> summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-23 02:37:02,379] [INFO]:  [METRICS] summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
>>> Writing to metrics_daily
[2026-01-23 02:37:02,395] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
>>> metrics_daily write complete
[2026-01-23 02:37:02,395] [INFO]: >>> metrics_daily write complete
[2026-01-23 02:37:02,395] [INFO]:  [METRICS] metrics_daily DB write complete
>>> METRICS COMPLETE <<<
[2026-01-23 02:37:02,408] [INFO]: >>> METRICS MAIN COMPLETED <<<
[2026-01-23 02:37:02,408] [INFO]:  [METRICS] main() complete
[2026-01-23 02:37:02,408] [INFO]: [INFO] metrics.py completed successfully
[2026-01-23T02:37:02.619567+00:00] END metrics rc=0 secs=1.7
[2026-01-23T03:00:15.537211+00:00] START metrics
>>> METRICS FILE EXECUTED <<<
[2026-01-23 03:00:16,582] [INFO]: Metrics script started
>>> METRICS MAIN ENTERED <<<
[2026-01-23 03:00:16,583] [INFO]: >>> METRICS MAIN ENTERED <<<
[2026-01-23 03:00:16,583] [INFO]:  [METRICS] main() start
[2026-01-23 03:00:16,598] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-22 source=cli
>>> Loaded screener_df and backtest_df
>>> screener_df rows: 8
[2026-01-23 03:00:16,627] [INFO]: >>> screener_df rows: 8
>>> backtest_df rows: 8
[2026-01-23 03:00:16,627] [INFO]: >>> backtest_df rows: 8
>>> Input data loaded  proceeding to ranking <<<
>>> Starting rank_and_filter_candidates
[2026-01-23 03:00:16,633] [INFO]: >>> Starting rank_and_filter_candidates()
[2026-01-23 03:00:16,633] [INFO]:  [METRICS] Starting candidate ranking
>>> ranked_df rows: 8
[2026-01-23 03:00:16,642] [INFO]: >>> ranked_df rows: 8
[2026-01-23 03:00:16,643] [INFO]:  [METRICS] ranked_df rows: 8
[2026-01-23 03:00:16,643] [INFO]: [DEBUG] ranked_df shape: (8, 22)
[2026-01-23 03:00:16,643] [INFO]: [DEBUG] Ranked DataFrame columns: ['run_date', 'symbol', 'trades', 'win_rate', 'net_pnl', 'expectancy', 'profit_factor', 'max_drawdown', 'sharpe', 'sortino', 'created_at', 'avg_return', 'win_rate_norm', 'net_pnl_norm', 'trades_norm', 'avg_return_norm', 'score', 'entry_price', 'adv20', 'atrp', 'exchange', 'source']
[2026-01-23 03:00:16,643] [INFO]: Screener Metrics Summary: total_candidates=8, avg_score=0.17
[2026-01-23 03:00:16,643] [INFO]: Top 15 Screener Symbols: UAL, LIF, LTH, FLUT, BANC, PCTY, HBAN, WY
[2026-01-23 03:00:16,647] [INFO]: Top Candidates: symbol     score  win_rate      net_pnl
   UAL  0.854234 47.317744  1368.185929
   LIF  0.830812 52.678571  1463.123467
   LTH  0.558829 45.348837   431.651543
  FLUT  0.197025 41.346154  -522.298736
  BANC  0.044947 41.885626 -2079.987019
  PCTY -0.219683 44.238683 -3121.934729
  HBAN -0.309597 40.036900 -3480.092605
    WY -0.561798 39.539347 -4575.352193
>>> Attempting to insert 8 rows into top_candidates for run_date=2026-01-22
[2026-01-23 03:00:16,647] [WARNING]: Attempting to insert 8 rows into top_candidates for run_date=2026-01-22
[2026-01-23 03:00:16,670] [INFO]: [INFO] TOP_CANDIDATES_REPLACED run_date=2026-01-22 deleted=8
[2026-01-23 03:00:16,675] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=8
[2026-01-23 03:00:16,686] [WARNING]: [WARN] DB_SCHEMA_FAILED view=latest_top_candidates err=must be owner of view latest_top_candidates

>>> top_candidates write complete
[2026-01-23 03:00:16,686] [WARNING]: top_candidates write complete
[2026-01-23 03:00:16,686] [INFO]:  [METRICS] top_candidates DB write complete
[2026-01-23 03:00:16,692] [INFO]: Calculated Metrics: Trades=2, Net PnL=74.69, Win Rate=50.00%, Expectancy=37.34, Profit Factor=29.837780235945516, Max Drawdown=-2.59, Sharpe=1.31, Sortino=0.00
>>> summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-23 03:00:16,692] [INFO]: >>> summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-23 03:00:16,692] [INFO]:  [METRICS] summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
>>> Attempting to insert metrics_daily for run_date=2026-01-22
[2026-01-23 03:00:16,692] [WARNING]: Attempting to insert metrics_daily for run_date=2026-01-22
[2026-01-23 03:00:16,704] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
>>> metrics_daily write complete
[2026-01-23 03:00:16,704] [WARNING]: metrics_daily write complete
[2026-01-23 03:00:16,705] [INFO]:  [METRICS] metrics_daily DB write complete
>>> METRICS COMPLETE <<<
[2026-01-23 03:00:16,721] [INFO]: >>> METRICS MAIN COMPLETED <<<
[2026-01-23 03:00:16,721] [INFO]:  [METRICS] main() complete
[2026-01-23 03:00:16,721] [INFO]: [INFO] metrics.py completed successfully
[2026-01-23T03:00:16.859730+00:00] END metrics rc=0 secs=1.3
[2026-01-23T03:39:48.893835+00:00] START metrics
>>> METRICS FILE EXECUTED <<<
[2026-01-23 03:39:49,843] [INFO]: Metrics script started
>>> METRICS MAIN ENTERED <<<
[2026-01-23 03:39:49,844] [INFO]: >>> METRICS MAIN ENTERED <<<
[2026-01-23 03:39:49,844] [INFO]:  [METRICS] main() start
[2026-01-23 03:39:49,860] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-22 source=cli
>>> Loaded screener_df and backtest_df
>>> screener_df rows: 8
[2026-01-23 03:39:49,887] [INFO]: >>> screener_df rows: 8
[2026-01-23 03:39:49,887] [WARNING]: >>> screener_df rows: 8
>>> backtest_df rows: 8
[2026-01-23 03:39:49,887] [INFO]: >>> backtest_df rows: 8
[2026-01-23 03:39:49,887] [WARNING]: >>> backtest_df rows: 8
>>> Input data loaded  proceeding to ranking <<<
>>> Starting rank_and_filter_candidates
[2026-01-23 03:39:49,893] [INFO]: >>> Starting rank_and_filter_candidates()
[2026-01-23 03:39:49,893] [INFO]:  [METRICS] Starting candidate ranking
>>> ranked_df rows: 8
[2026-01-23 03:39:49,902] [INFO]: >>> ranked_df rows: 8
[2026-01-23 03:39:49,902] [WARNING]: >>> ranked_df rows: 8
[2026-01-23 03:39:49,902] [INFO]:  [METRICS] ranked_df rows: 8
[2026-01-23 03:39:49,902] [INFO]: [DEBUG] ranked_df shape: (8, 22)
[2026-01-23 03:39:49,902] [INFO]: [DEBUG] Ranked DataFrame columns: ['run_date', 'symbol', 'trades', 'win_rate', 'net_pnl', 'expectancy', 'profit_factor', 'max_drawdown', 'sharpe', 'sortino', 'created_at', 'avg_return', 'win_rate_norm', 'net_pnl_norm', 'trades_norm', 'avg_return_norm', 'score', 'entry_price', 'adv20', 'atrp', 'exchange', 'source']
[2026-01-23 03:39:49,902] [INFO]: Screener Metrics Summary: total_candidates=8, avg_score=0.17
[2026-01-23 03:39:49,903] [INFO]: Top 15 Screener Symbols: UAL, LIF, LTH, FLUT, BANC, PCTY, HBAN, WY
[2026-01-23 03:39:49,906] [INFO]: Top Candidates: symbol     score  win_rate      net_pnl
   UAL  0.854234 47.317744  1368.185929
   LIF  0.830812 52.678571  1463.123467
   LTH  0.558829 45.348837   431.651543
  FLUT  0.197025 41.346154  -522.298736
  BANC  0.044947 41.885626 -2079.987019
  PCTY -0.219683 44.238683 -3121.934729
  HBAN -0.309597 40.036900 -3480.092605
    WY -0.561798 39.539347 -4575.352193
>>> db.db_enabled(): True
[2026-01-23 03:39:49,906] [WARNING]: >>> db.db_enabled(): True
>>> Attempting to write top_candidates to DB
[2026-01-23 03:39:49,906] [WARNING]: >>> Writing top_candidates to DB
>>> Attempting to insert 8 rows into top_candidates for run_date=2026-01-22
[2026-01-23 03:39:49,906] [WARNING]: Attempting to insert 8 rows into top_candidates for run_date=2026-01-22
[2026-01-23 03:39:49,929] [INFO]: [INFO] TOP_CANDIDATES_REPLACED run_date=2026-01-22 deleted=8
[2026-01-23 03:39:49,933] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=8
[2026-01-23 03:39:49,944] [WARNING]: [WARN] DB_SCHEMA_FAILED view=latest_top_candidates err=must be owner of view latest_top_candidates

>>> top_candidates write complete
[2026-01-23 03:39:49,944] [WARNING]: >>> top_candidates write complete
[2026-01-23 03:39:49,944] [INFO]:  [METRICS] top_candidates DB write complete
[2026-01-23 03:39:49,953] [INFO]: Calculated Metrics: Trades=2, Net PnL=74.69, Win Rate=50.00%, Expectancy=37.34, Profit Factor=29.837780235945516, Max Drawdown=-2.59, Sharpe=1.31, Sortino=0.00
>>> summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-23 03:39:49,953] [INFO]: >>> summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-23 03:39:49,953] [WARNING]: >>> summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-23 03:39:49,953] [INFO]:  [METRICS] summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
>>> db.db_enabled(): True
[2026-01-23 03:39:49,954] [WARNING]: >>> db.db_enabled(): True
>>> Attempting to write metrics_daily to DB
[2026-01-23 03:39:49,954] [WARNING]: >>> Writing metrics_daily to DB
>>> Attempting to insert metrics_daily for run_date=2026-01-22
[2026-01-23 03:39:49,954] [WARNING]: Attempting to insert metrics_daily for run_date=2026-01-22
[2026-01-23 03:39:49,966] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
>>> metrics_daily write complete
[2026-01-23 03:39:49,966] [WARNING]: >>> metrics_daily write complete
[2026-01-23 03:39:49,966] [INFO]:  [METRICS] metrics_daily DB write complete
>>> METRICS COMPLETE <<<
>>> METRICS FILE COMPLETED <<<
[2026-01-23 03:39:49,980] [INFO]: >>> METRICS MAIN COMPLETED <<<
[2026-01-23 03:39:49,981] [INFO]:  [METRICS] main() complete
[2026-01-23 03:39:49,981] [INFO]: [INFO] metrics.py completed successfully
[2026-01-23T03:39:50.119427+00:00] END metrics rc=0 secs=1.2
[2026-01-23T04:05:33.845989+00:00] START metrics
>>> METRICS FILE EXECUTED <<<
[2026-01-23 04:05:37,046] [INFO]: Metrics script started
>>> METRICS MAIN ENTERED <<<
[2026-01-23 04:05:37,047] [INFO]: >>> METRICS MAIN ENTERED <<<
[2026-01-23 04:05:37,047] [INFO]:  [METRICS] main() start
[2026-01-23 04:05:37,089] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-22 source=cli
>>> Loaded screener_df and backtest_df
>>> screener_df rows: 8
[2026-01-23 04:05:37,135] [INFO]: >>> screener_df rows: 8
[2026-01-23 04:05:37,136] [WARNING]: >>> screener_df rows: 8
>>> backtest_df rows: 8
[2026-01-23 04:05:37,136] [INFO]: >>> backtest_df rows: 8
[2026-01-23 04:05:37,136] [WARNING]: >>> backtest_df rows: 8
>>> Input data loaded  proceeding to ranking <<<
>>> Starting rank_and_filter_candidates
[2026-01-23 04:05:37,161] [INFO]: >>> Starting rank_and_filter_candidates()
[2026-01-23 04:05:37,161] [INFO]:  [METRICS] Starting candidate ranking
>>> ranked_df rows: 8
[2026-01-23 04:05:37,185] [INFO]: >>> ranked_df rows: 8
[2026-01-23 04:05:37,185] [WARNING]: >>> ranked_df rows: 8
[2026-01-23 04:05:37,185] [INFO]:  [METRICS] ranked_df rows: 8
[2026-01-23 04:05:37,186] [INFO]: [DEBUG] ranked_df shape: (8, 22)
[2026-01-23 04:05:37,186] [INFO]: [DEBUG] Ranked DataFrame columns: ['run_date', 'symbol', 'trades', 'win_rate', 'net_pnl', 'expectancy', 'profit_factor', 'max_drawdown', 'sharpe', 'sortino', 'created_at', 'avg_return', 'win_rate_norm', 'net_pnl_norm', 'trades_norm', 'avg_return_norm', 'score', 'entry_price', 'adv20', 'atrp', 'exchange', 'source']
[2026-01-23 04:05:37,186] [INFO]: Screener Metrics Summary: total_candidates=8, avg_score=0.17
[2026-01-23 04:05:37,188] [INFO]: Top 15 Screener Symbols: UAL, LIF, LTH, FLUT, BANC, PCTY, HBAN, WY
[2026-01-23 04:05:37,200] [INFO]: Top Candidates: symbol     score  win_rate      net_pnl
   UAL  0.854234 47.317744  1368.185929
   LIF  0.830812 52.678571  1463.123467
   LTH  0.558829 45.348837   431.651543
  FLUT  0.197025 41.346154  -522.298736
  BANC  0.044947 41.885626 -2079.987019
  PCTY -0.219683 44.238683 -3121.934729
  HBAN -0.309597 40.036900 -3480.092605
    WY -0.561798 39.539347 -4575.352193
>>> db.db_enabled(): True
[2026-01-23 04:05:37,200] [WARNING]: >>> db.db_enabled(): True
>>> Attempting to insert 8 rows into top_candidates
[2026-01-23 04:05:37,201] [WARNING]: >>> Inserting into top_candidates: rows=8
[2026-01-23 04:05:37,261] [INFO]: [INFO] TOP_CANDIDATES_REPLACED run_date=2026-01-22 deleted=8
[2026-01-23 04:05:37,266] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=8
[2026-01-23 04:05:37,292] [WARNING]: [WARN] DB_SCHEMA_FAILED view=latest_top_candidates err=must be owner of view latest_top_candidates

>>> insert_top_candidates completed successfully
[2026-01-23 04:05:37,331] [INFO]: Calculated Metrics: Trades=2, Net PnL=74.69, Win Rate=50.00%, Expectancy=37.34, Profit Factor=29.837780235945516, Max Drawdown=-2.59, Sharpe=1.31, Sortino=0.00
>>> summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-23 04:05:37,331] [INFO]: >>> summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-23 04:05:37,331] [WARNING]: >>> summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-23 04:05:37,331] [INFO]:  [METRICS] summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
>>> db.db_enabled(): True
[2026-01-23 04:05:37,332] [WARNING]: >>> db.db_enabled(): True
>>> Attempting to upsert metrics_daily: keys=['total_trades', 'net_pnl', 'win_rate', 'expectancy', 'profit_factor', 'max_drawdown', 'sharpe', 'sortino']
[2026-01-23 04:05:37,332] [WARNING]: >>> Upserting metrics_daily: keys=['total_trades', 'net_pnl', 'win_rate', 'expectancy', 'profit_factor', 'max_drawdown', 'sharpe', 'sortino']
[2026-01-23 04:05:37,362] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
>>> upsert_metrics_daily completed successfully
>>> METRICS COMPLETE <<<
>>> METRICS FILE COMPLETED <<<
[2026-01-23 04:05:37,382] [INFO]: >>> METRICS MAIN COMPLETED <<<
[2026-01-23 04:05:37,382] [INFO]:  [METRICS] main() complete
[2026-01-23 04:05:37,382] [INFO]: [INFO] metrics.py completed successfully
[2026-01-23T04:05:37.984227+00:00] END metrics rc=0 secs=4.1
[2026-01-23T04:10:40.434495+00:00] START metrics
>>> METRICS FILE EXECUTED <<<
[2026-01-23 04:10:41,378] [INFO]: Metrics script started
>>> METRICS MAIN ENTERED <<<
[2026-01-23 04:10:41,379] [INFO]: >>> METRICS MAIN ENTERED <<<
[2026-01-23 04:10:41,379] [INFO]:  [METRICS] main() start
[2026-01-23 04:10:41,396] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-22 source=cli
>>> Loaded screener_df and backtest_df
>>> screener_df rows: 8
[2026-01-23 04:10:41,424] [INFO]: >>> screener_df rows: 8
[2026-01-23 04:10:41,424] [WARNING]: >>> screener_df rows: 8
>>> backtest_df rows: 8
[2026-01-23 04:10:41,424] [INFO]: >>> backtest_df rows: 8
[2026-01-23 04:10:41,424] [WARNING]: >>> backtest_df rows: 8
>>> Input data loaded  proceeding to ranking <<<
>>> Starting rank_and_filter_candidates
[2026-01-23 04:10:41,431] [INFO]: >>> Starting rank_and_filter_candidates()
[2026-01-23 04:10:41,431] [INFO]:  [METRICS] Starting candidate ranking
>>> ranked_df rows: 8
[2026-01-23 04:10:41,440] [INFO]: >>> ranked_df rows: 8
[2026-01-23 04:10:41,440] [WARNING]: >>> ranked_df rows: 8
[2026-01-23 04:10:41,440] [INFO]:  [METRICS] ranked_df rows: 8
[2026-01-23 04:10:41,440] [INFO]: [DEBUG] ranked_df shape: (8, 22)
[2026-01-23 04:10:41,440] [INFO]: [DEBUG] Ranked DataFrame columns: ['run_date', 'symbol', 'trades', 'win_rate', 'net_pnl', 'expectancy', 'profit_factor', 'max_drawdown', 'sharpe', 'sortino', 'created_at', 'avg_return', 'win_rate_norm', 'net_pnl_norm', 'trades_norm', 'avg_return_norm', 'score', 'entry_price', 'adv20', 'atrp', 'exchange', 'source']
[2026-01-23 04:10:41,441] [INFO]: Screener Metrics Summary: total_candidates=8, avg_score=0.17
[2026-01-23 04:10:41,441] [INFO]: Top 15 Screener Symbols: UAL, LIF, LTH, FLUT, BANC, PCTY, HBAN, WY
[2026-01-23 04:10:41,444] [INFO]: Top Candidates: symbol     score  win_rate      net_pnl
   UAL  0.854234 47.317744  1368.185929
   LIF  0.830812 52.678571  1463.123467
   LTH  0.558829 45.348837   431.651543
  FLUT  0.197025 41.346154  -522.298736
  BANC  0.044947 41.885626 -2079.987019
  PCTY -0.219683 44.238683 -3121.934729
  HBAN -0.309597 40.036900 -3480.092605
    WY -0.561798 39.539347 -4575.352193
>>> db.db_enabled(): True
[2026-01-23 04:10:41,444] [WARNING]: >>> db.db_enabled(): True
>>> Attempting to insert 8 rows into top_candidates
[2026-01-23 04:10:41,444] [WARNING]: >>> Inserting into top_candidates: rows=8
[2026-01-23 04:10:41,470] [INFO]: [INFO] TOP_CANDIDATES_REPLACED run_date=2026-01-22 deleted=8
[2026-01-23 04:10:41,475] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=8
[2026-01-23 04:10:41,486] [WARNING]: [WARN] DB_SCHEMA_FAILED view=latest_top_candidates err=must be owner of view latest_top_candidates

>>> insert_top_candidates completed successfully
[2026-01-23 04:10:41,492] [INFO]: Calculated Metrics: Trades=2, Net PnL=74.69, Win Rate=50.00%, Expectancy=37.34, Profit Factor=29.837780235945516, Max Drawdown=-2.59, Sharpe=1.31, Sortino=0.00
>>> summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-23 04:10:41,492] [INFO]: >>> summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-23 04:10:41,492] [WARNING]: >>> summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-23 04:10:41,492] [INFO]:  [METRICS] summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
>>> db.db_enabled(): True
[2026-01-23 04:10:41,492] [WARNING]: >>> db.db_enabled(): True
>>> Attempting to upsert metrics_daily: keys=['total_trades', 'net_pnl', 'win_rate', 'expectancy', 'profit_factor', 'max_drawdown', 'sharpe', 'sortino']
[2026-01-23 04:10:41,492] [WARNING]: >>> Upserting metrics_daily: keys=['total_trades', 'net_pnl', 'win_rate', 'expectancy', 'profit_factor', 'max_drawdown', 'sharpe', 'sortino']
[2026-01-23 04:10:41,505] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
>>> upsert_metrics_daily completed successfully
>>> METRICS COMPLETE <<<
>>> METRICS FILE COMPLETED <<<
[2026-01-23 04:10:41,517] [INFO]: >>> METRICS MAIN COMPLETED <<<
[2026-01-23 04:10:41,517] [INFO]:  [METRICS] main() complete
[2026-01-23 04:10:41,517] [INFO]: [INFO] metrics.py completed successfully
[2026-01-23T04:10:41.658979+00:00] END metrics rc=0 secs=1.2
[2026-01-23T04:49:54.435869+00:00] START metrics
>>> METRICS FILE EXECUTED <<<
[2026-01-23 04:50:18,428] [INFO]: Metrics script started
>>> METRICS MAIN ENTERED <<<
[2026-01-23 04:50:18,429] [INFO]: >>> METRICS MAIN ENTERED <<<
[2026-01-23 04:50:18,429] [INFO]:  [METRICS] main() start
[2026-01-23 04:50:18,632] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-22 source=cli
>>> Loaded screener_df and backtest_df
>>> screener_df rows: 8
[2026-01-23 04:50:18,744] [INFO]: >>> screener_df rows: 8
[2026-01-23 04:50:18,744] [WARNING]: >>> screener_df rows: 8
>>> backtest_df rows: 8
[2026-01-23 04:50:18,744] [INFO]: >>> backtest_df rows: 8
[2026-01-23 04:50:18,744] [WARNING]: >>> backtest_df rows: 8
>>> Input data loaded  proceeding to ranking <<<
>>> Starting rank_and_filter_candidates
[2026-01-23 04:50:18,930] [INFO]: >>> Starting rank_and_filter_candidates()
[2026-01-23 04:50:18,930] [INFO]:  [METRICS] Starting candidate ranking
>>> ranked_df rows: 8
[2026-01-23 04:50:19,228] [INFO]: >>> ranked_df rows: 8
[2026-01-23 04:50:19,228] [WARNING]: >>> ranked_df rows: 8
[2026-01-23 04:50:19,229] [INFO]:  [METRICS] ranked_df rows: 8
[2026-01-23 04:50:19,229] [INFO]: [DEBUG] ranked_df shape: (8, 22)
[2026-01-23 04:50:19,229] [INFO]: [DEBUG] Ranked DataFrame columns: ['run_date', 'symbol', 'trades', 'win_rate', 'net_pnl', 'expectancy', 'profit_factor', 'max_drawdown', 'sharpe', 'sortino', 'created_at', 'avg_return', 'win_rate_norm', 'net_pnl_norm', 'trades_norm', 'avg_return_norm', 'score', 'entry_price', 'adv20', 'atrp', 'exchange', 'source']
[2026-01-23 04:50:19,229] [INFO]: Screener Metrics Summary: total_candidates=8, avg_score=0.17
[2026-01-23 04:50:19,230] [INFO]: Top 15 Screener Symbols: UAL, LIF, LTH, FLUT, BANC, PCTY, HBAN, WY
[2026-01-23 04:50:19,428] [INFO]: Top Candidates: symbol     score  win_rate      net_pnl
   UAL  0.854234 47.317744  1368.185929
   LIF  0.830812 52.678571  1463.123467
   LTH  0.558829 45.348837   431.651543
  FLUT  0.197025 41.346154  -522.298736
  BANC  0.044947 41.885626 -2079.987019
  PCTY -0.219683 44.238683 -3121.934729
  HBAN -0.309597 40.036900 -3480.092605
    WY -0.561798 39.539347 -4575.352193
>>> db.db_enabled(): True
[2026-01-23 04:50:19,428] [WARNING]: >>> db.db_enabled(): True
>>> Attempting to insert 8 rows into top_candidates
[2026-01-23 04:50:19,428] [WARNING]: >>> Inserting into top_candidates: rows=8
[2026-01-23 04:50:19,632] [INFO]: [INFO] TOP_CANDIDATES_REPLACED run_date=2026-01-22 deleted=8
[2026-01-23 04:50:19,637] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=8
>>> insert_top_candidates completed successfully
[2026-01-23 04:50:19,832] [INFO]: Calculated Metrics: Trades=2, Net PnL=74.69, Win Rate=50.00%, Expectancy=37.34, Profit Factor=29.837780235945516, Max Drawdown=-2.59, Sharpe=1.31, Sortino=0.00
>>> summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-23 04:50:19,927] [INFO]: >>> summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-23 04:50:19,927] [WARNING]: >>> summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
[2026-01-23 04:50:19,927] [INFO]:  [METRICS] summary_metrics: {'total_trades': 2, 'net_pnl': 74.68999500000062, 'win_rate': 50.0, 'expectancy': 37.34499750000031, 'profit_factor': 29.837780235945516, 'max_drawdown': -2.590005000000019, 'sharpe': 1.3100834190883026, 'sortino': 0.0}
>>> db.db_enabled(): True
[2026-01-23 04:50:19,928] [WARNING]: >>> db.db_enabled(): True
>>> Attempting to upsert metrics_daily: keys=['total_trades', 'net_pnl', 'win_rate', 'expectancy', 'profit_factor', 'max_drawdown', 'sharpe', 'sortino']
[2026-01-23 04:50:19,928] [WARNING]: >>> Upserting metrics_daily: keys=['total_trades', 'net_pnl', 'win_rate', 'expectancy', 'profit_factor', 'max_drawdown', 'sharpe', 'sortino']
[2026-01-23 04:50:19,940] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
>>> upsert_metrics_daily completed successfully
>>> METRICS COMPLETE <<<
>>> METRICS FILE COMPLETED <<<
[2026-01-23 04:50:20,139] [INFO]: >>> METRICS MAIN COMPLETED <<<
[2026-01-23 04:50:20,139] [INFO]:  [METRICS] main() complete
[2026-01-23 04:50:20,139] [INFO]: [INFO] metrics.py completed successfully
[2026-01-23T04:50:24.327717+00:00] END metrics rc=0 secs=29.9
[2026-01-24T03:58:21.613550+00:00] START metrics
>>> METRICS FILE EXECUTED <<<
[2026-01-24 03:58:22,567] [INFO]: Metrics script started
>>> METRICS MAIN ENTERED <<<
[2026-01-24 03:58:22,567] [INFO]: >>> METRICS MAIN ENTERED <<<
[2026-01-24 03:58:22,567] [INFO]:  [METRICS] main() start
[2026-01-24 03:58:22,584] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-23 source=cli
>>> Loaded screener_df and backtest_df
>>> screener_df rows: 6
[2026-01-24 03:58:22,615] [INFO]: >>> screener_df rows: 6
[2026-01-24 03:58:22,615] [WARNING]: >>> screener_df rows: 6
>>> backtest_df rows: 5
[2026-01-24 03:58:22,615] [INFO]: >>> backtest_df rows: 5
[2026-01-24 03:58:22,615] [WARNING]: >>> backtest_df rows: 5
>>> Input data loaded  proceeding to ranking <<<
>>> Starting rank_and_filter_candidates
[2026-01-24 03:58:22,622] [INFO]: >>> Starting rank_and_filter_candidates()
[2026-01-24 03:58:22,622] [INFO]:  [METRICS] Starting candidate ranking
>>> ranked_df rows: 5
[2026-01-24 03:58:22,631] [INFO]: >>> ranked_df rows: 5
[2026-01-24 03:58:22,631] [WARNING]: >>> ranked_df rows: 5
[2026-01-24 03:58:22,631] [INFO]:  [METRICS] ranked_df rows: 5
[2026-01-24 03:58:22,631] [INFO]: [DEBUG] ranked_df shape: (5, 22)
[2026-01-24 03:58:22,631] [INFO]: [DEBUG] Ranked DataFrame columns: ['run_date', 'symbol', 'trades', 'win_rate', 'net_pnl', 'expectancy', 'profit_factor', 'max_drawdown', 'sharpe', 'sortino', 'created_at', 'avg_return', 'win_rate_norm', 'net_pnl_norm', 'trades_norm', 'avg_return_norm', 'score', 'entry_price', 'adv20', 'atrp', 'exchange', 'source']
[2026-01-24 03:58:22,632] [INFO]: Screener Metrics Summary: total_candidates=5, avg_score=1.03
[2026-01-24 03:58:22,632] [INFO]: Top 15 Screener Symbols: GGB, CVE, AMD, CMC, HSY
[2026-01-24 03:58:22,636] [INFO]: Top Candidates: symbol    score  win_rate      net_pnl
   GGB 1.125535 42.768274 -4150.360500
   CVE 1.062772 45.000000 -3492.157029
   AMD 1.028000 45.696970 -3200.427486
   CMC 0.989951 43.956044 -3036.466945
   HSY 0.931695 40.771812 -2936.722192
>>> db.db_enabled(): True
[2026-01-24 03:58:22,637] [WARNING]: >>> db.db_enabled(): True
>>> Attempting to insert 5 rows into top_candidates
[2026-01-24 03:58:22,637] [WARNING]: >>> Inserting into top_candidates: rows=5
[2026-01-24 03:58:22,663] [INFO]: [INFO] TOP_CANDIDATES_REPLACED run_date=2026-01-23 deleted=0
[2026-01-24 03:58:22,669] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=5
>>> insert_top_candidates completed successfully
[2026-01-24 03:58:22,690] [INFO]: Calculated Metrics: Trades=3, Net PnL=41.83, Win Rate=33.33%, Expectancy=13.94, Profit Factor=2.1799714837840063, Max Drawdown=-2.59, Sharpe=-0.45, Sortino=-0.58
>>> summary_metrics: {'total_trades': 3, 'net_pnl': 41.82999500000055, 'win_rate': 33.33333333333333, 'expectancy': 13.94333166666685, 'profit_factor': 2.1799714837840063, 'max_drawdown': -2.590005000000019, 'sharpe': -0.45373724864683473, 'sortino': -0.5840749705008051}
[2026-01-24 03:58:22,690] [INFO]: >>> summary_metrics: {'total_trades': 3, 'net_pnl': 41.82999500000055, 'win_rate': 33.33333333333333, 'expectancy': 13.94333166666685, 'profit_factor': 2.1799714837840063, 'max_drawdown': -2.590005000000019, 'sharpe': -0.45373724864683473, 'sortino': -0.5840749705008051}
[2026-01-24 03:58:22,690] [WARNING]: >>> summary_metrics: {'total_trades': 3, 'net_pnl': 41.82999500000055, 'win_rate': 33.33333333333333, 'expectancy': 13.94333166666685, 'profit_factor': 2.1799714837840063, 'max_drawdown': -2.590005000000019, 'sharpe': -0.45373724864683473, 'sortino': -0.5840749705008051}
[2026-01-24 03:58:22,690] [INFO]:  [METRICS] summary_metrics: {'total_trades': 3, 'net_pnl': 41.82999500000055, 'win_rate': 33.33333333333333, 'expectancy': 13.94333166666685, 'profit_factor': 2.1799714837840063, 'max_drawdown': -2.590005000000019, 'sharpe': -0.45373724864683473, 'sortino': -0.5840749705008051}
>>> db.db_enabled(): True
[2026-01-24 03:58:22,690] [WARNING]: >>> db.db_enabled(): True
>>> Attempting to upsert metrics_daily: keys=['total_trades', 'net_pnl', 'win_rate', 'expectancy', 'profit_factor', 'max_drawdown', 'sharpe', 'sortino']
[2026-01-24 03:58:22,690] [WARNING]: >>> Upserting metrics_daily: keys=['total_trades', 'net_pnl', 'win_rate', 'expectancy', 'profit_factor', 'max_drawdown', 'sharpe', 'sortino']
[2026-01-24 03:58:22,704] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
>>> upsert_metrics_daily completed successfully
>>> METRICS COMPLETE <<<
>>> METRICS FILE COMPLETED <<<
[2026-01-24 03:58:22,716] [INFO]: >>> METRICS MAIN COMPLETED <<<
[2026-01-24 03:58:22,717] [INFO]:  [METRICS] main() complete
[2026-01-24 03:58:22,717] [INFO]: [INFO] metrics.py completed successfully
[2026-01-24T03:58:22.839785+00:00] END metrics rc=0 secs=1.2
[2026-01-25T04:02:34.631942+00:00] START metrics
>>> METRICS FILE EXECUTED <<<
[2026-01-25 04:02:35,896] [INFO]: Metrics script started
>>> METRICS MAIN ENTERED <<<
[2026-01-25 04:02:35,897] [INFO]: >>> METRICS MAIN ENTERED <<<
[2026-01-25 04:02:35,897] [INFO]:  [METRICS] main() start
[2026-01-25 04:02:35,919] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-23 source=cli
>>> Loaded screener_df and backtest_df
>>> screener_df rows: 9
[2026-01-25 04:02:35,957] [INFO]: >>> screener_df rows: 9
[2026-01-25 04:02:35,958] [WARNING]: >>> screener_df rows: 9
>>> backtest_df rows: 8
[2026-01-25 04:02:35,958] [INFO]: >>> backtest_df rows: 8
[2026-01-25 04:02:35,958] [WARNING]: >>> backtest_df rows: 8
>>> Input data loaded  proceeding to ranking <<<
>>> Starting rank_and_filter_candidates
[2026-01-25 04:02:35,969] [INFO]: >>> Starting rank_and_filter_candidates()
[2026-01-25 04:02:35,969] [INFO]:  [METRICS] Starting candidate ranking
>>> ranked_df rows: 8
[2026-01-25 04:02:35,983] [INFO]: >>> ranked_df rows: 8
[2026-01-25 04:02:35,983] [WARNING]: >>> ranked_df rows: 8
[2026-01-25 04:02:35,983] [INFO]:  [METRICS] ranked_df rows: 8
[2026-01-25 04:02:35,983] [INFO]: [DEBUG] ranked_df shape: (8, 22)
[2026-01-25 04:02:35,983] [INFO]: [DEBUG] Ranked DataFrame columns: ['run_date', 'symbol', 'trades', 'win_rate', 'net_pnl', 'expectancy', 'profit_factor', 'max_drawdown', 'sharpe', 'sortino', 'created_at', 'avg_return', 'win_rate_norm', 'net_pnl_norm', 'trades_norm', 'avg_return_norm', 'score', 'entry_price', 'adv20', 'atrp', 'exchange', 'source']
[2026-01-25 04:02:35,983] [INFO]: Screener Metrics Summary: total_candidates=8, avg_score=-1.02
[2026-01-25 04:02:35,984] [INFO]: Top 15 Screener Symbols: BKD, DINO, PBR, CVE, CMC, HSY, GGB, AMD
[2026-01-25 04:02:35,990] [INFO]: Top Candidates: symbol     score  win_rate      net_pnl
   BKD  1.000000 45.631068   611.582293
  DINO -0.664505 45.043103 -1707.603845
   PBR -0.674925 43.307087 -1558.518493
   CVE -1.085664 43.571429 -2193.239721
   CMC -1.109521 42.284569 -2368.820117
   HSY -1.387819 37.183099 -2359.010721
   GGB -1.506639 42.005420 -2609.017479
   AMD -2.735212 41.325536 -4746.837014
>>> db.db_enabled(): True
[2026-01-25 04:02:35,990] [WARNING]: >>> db.db_enabled(): True
>>> Attempting to insert 8 rows into top_candidates
[2026-01-25 04:02:35,990] [WARNING]: >>> Inserting into top_candidates: rows=8
[2026-01-25 04:02:36,025] [INFO]: [INFO] TOP_CANDIDATES_REPLACED run_date=2026-01-23 deleted=5
[2026-01-25 04:02:36,030] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=8
>>> insert_top_candidates completed successfully
[2026-01-25 04:02:36,058] [INFO]: Calculated Metrics: Trades=3, Net PnL=41.83, Win Rate=33.33%, Expectancy=13.94, Profit Factor=2.1799714837840063, Max Drawdown=-2.59, Sharpe=-0.45, Sortino=-0.58
>>> summary_metrics: {'total_trades': 3, 'net_pnl': 41.82999500000055, 'win_rate': 33.33333333333333, 'expectancy': 13.94333166666685, 'profit_factor': 2.1799714837840063, 'max_drawdown': -2.590005000000019, 'sharpe': -0.45373724864683473, 'sortino': -0.5840749705008051}
[2026-01-25 04:02:36,059] [INFO]: >>> summary_metrics: {'total_trades': 3, 'net_pnl': 41.82999500000055, 'win_rate': 33.33333333333333, 'expectancy': 13.94333166666685, 'profit_factor': 2.1799714837840063, 'max_drawdown': -2.590005000000019, 'sharpe': -0.45373724864683473, 'sortino': -0.5840749705008051}
[2026-01-25 04:02:36,059] [WARNING]: >>> summary_metrics: {'total_trades': 3, 'net_pnl': 41.82999500000055, 'win_rate': 33.33333333333333, 'expectancy': 13.94333166666685, 'profit_factor': 2.1799714837840063, 'max_drawdown': -2.590005000000019, 'sharpe': -0.45373724864683473, 'sortino': -0.5840749705008051}
[2026-01-25 04:02:36,059] [INFO]:  [METRICS] summary_metrics: {'total_trades': 3, 'net_pnl': 41.82999500000055, 'win_rate': 33.33333333333333, 'expectancy': 13.94333166666685, 'profit_factor': 2.1799714837840063, 'max_drawdown': -2.590005000000019, 'sharpe': -0.45373724864683473, 'sortino': -0.5840749705008051}
>>> db.db_enabled(): True
[2026-01-25 04:02:36,059] [WARNING]: >>> db.db_enabled(): True
>>> Attempting to upsert metrics_daily: keys=['total_trades', 'net_pnl', 'win_rate', 'expectancy', 'profit_factor', 'max_drawdown', 'sharpe', 'sortino']
[2026-01-25 04:02:36,059] [WARNING]: >>> Upserting metrics_daily: keys=['total_trades', 'net_pnl', 'win_rate', 'expectancy', 'profit_factor', 'max_drawdown', 'sharpe', 'sortino']
[2026-01-25 04:02:36,075] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
>>> upsert_metrics_daily completed successfully
>>> METRICS COMPLETE <<<
>>> METRICS FILE COMPLETED <<<
[2026-01-25 04:02:36,088] [INFO]: >>> METRICS MAIN COMPLETED <<<
[2026-01-25 04:02:36,089] [INFO]:  [METRICS] main() complete
[2026-01-25 04:02:36,089] [INFO]: [INFO] metrics.py completed successfully
[2026-01-25T04:02:36.316754+00:00] END metrics rc=0 secs=1.7
[2026-01-26T04:02:44.694067+00:00] START metrics
>>> METRICS FILE EXECUTED <<<
[2026-01-26 04:02:45,891] [INFO]: Metrics script started
>>> METRICS MAIN ENTERED <<<
[2026-01-26 04:02:45,891] [INFO]: >>> METRICS MAIN ENTERED <<<
[2026-01-26 04:02:45,891] [INFO]:  [METRICS] main() start
[2026-01-26 04:02:45,908] [INFO]: [INFO] STEP_RUN_DATE step=metrics run_date=2026-01-23 source=cli
>>> Loaded screener_df and backtest_df
>>> screener_df rows: 12
[2026-01-26 04:02:45,940] [INFO]: >>> screener_df rows: 12
[2026-01-26 04:02:45,940] [WARNING]: >>> screener_df rows: 12
>>> backtest_df rows: 11
[2026-01-26 04:02:45,940] [INFO]: >>> backtest_df rows: 11
[2026-01-26 04:02:45,940] [WARNING]: >>> backtest_df rows: 11
>>> Input data loaded  proceeding to ranking <<<
>>> Starting rank_and_filter_candidates
[2026-01-26 04:02:45,947] [INFO]: >>> Starting rank_and_filter_candidates()
[2026-01-26 04:02:45,947] [INFO]:  [METRICS] Starting candidate ranking
>>> ranked_df rows: 11
[2026-01-26 04:02:45,958] [INFO]: >>> ranked_df rows: 11
[2026-01-26 04:02:45,958] [WARNING]: >>> ranked_df rows: 11
[2026-01-26 04:02:45,958] [INFO]:  [METRICS] ranked_df rows: 11
[2026-01-26 04:02:45,958] [INFO]: [DEBUG] ranked_df shape: (11, 22)
[2026-01-26 04:02:45,958] [INFO]: [DEBUG] Ranked DataFrame columns: ['run_date', 'symbol', 'trades', 'win_rate', 'net_pnl', 'expectancy', 'profit_factor', 'max_drawdown', 'sharpe', 'sortino', 'created_at', 'avg_return', 'win_rate_norm', 'net_pnl_norm', 'trades_norm', 'avg_return_norm', 'score', 'entry_price', 'adv20', 'atrp', 'exchange', 'source']
[2026-01-26 04:02:45,959] [INFO]: Screener Metrics Summary: total_candidates=11, avg_score=8.29
[2026-01-26 04:02:45,959] [INFO]: Top 15 Screener Symbols: DINO, HSY, BDX, GGB, CMC, CVE, AMD, PBR, FORM, BKD, GS
[2026-01-26 04:02:45,965] [INFO]: Top Candidates: symbol     score  win_rate      net_pnl
  DINO 13.019070 42.140468 -2242.821807
   HSY 12.085774 35.379061 -2052.000071
   BDX 10.591804 36.057692 -1663.598819
   GGB 10.401792 42.641509 -1726.415129
   CMC  9.549970 44.270833 -1693.354186
   CVE  9.107373 44.807122 -1573.255457
   AMD  8.075181 42.814371 -1384.436307
   PBR  7.253393 44.194757 -1176.982386
  FORM  5.872236 44.590164  -960.984064
   BKD  4.319193 43.636364  -719.885929
    GS  0.911504 44.313725   -69.091414
>>> db.db_enabled(): True
[2026-01-26 04:02:45,965] [WARNING]: >>> db.db_enabled(): True
>>> Attempting to insert 11 rows into top_candidates
[2026-01-26 04:02:45,965] [WARNING]: >>> Inserting into top_candidates: rows=11
[2026-01-26 04:02:45,994] [INFO]: [INFO] TOP_CANDIDATES_REPLACED run_date=2026-01-23 deleted=8
[2026-01-26 04:02:46,002] [INFO]: [INFO] DB_WRITE_OK table=top_candidates rows=11
>>> insert_top_candidates completed successfully
[2026-01-26 04:02:46,030] [INFO]: Calculated Metrics: Trades=3, Net PnL=41.83, Win Rate=33.33%, Expectancy=13.94, Profit Factor=2.1799714837840063, Max Drawdown=-2.59, Sharpe=-0.45, Sortino=-0.58
>>> summary_metrics: {'total_trades': 3, 'net_pnl': 41.82999500000055, 'win_rate': 33.33333333333333, 'expectancy': 13.94333166666685, 'profit_factor': 2.1799714837840063, 'max_drawdown': -2.590005000000019, 'sharpe': -0.45373724864683473, 'sortino': -0.5840749705008051}
[2026-01-26 04:02:46,030] [INFO]: >>> summary_metrics: {'total_trades': 3, 'net_pnl': 41.82999500000055, 'win_rate': 33.33333333333333, 'expectancy': 13.94333166666685, 'profit_factor': 2.1799714837840063, 'max_drawdown': -2.590005000000019, 'sharpe': -0.45373724864683473, 'sortino': -0.5840749705008051}
[2026-01-26 04:02:46,030] [WARNING]: >>> summary_metrics: {'total_trades': 3, 'net_pnl': 41.82999500000055, 'win_rate': 33.33333333333333, 'expectancy': 13.94333166666685, 'profit_factor': 2.1799714837840063, 'max_drawdown': -2.590005000000019, 'sharpe': -0.45373724864683473, 'sortino': -0.5840749705008051}
[2026-01-26 04:02:46,030] [INFO]:  [METRICS] summary_metrics: {'total_trades': 3, 'net_pnl': 41.82999500000055, 'win_rate': 33.33333333333333, 'expectancy': 13.94333166666685, 'profit_factor': 2.1799714837840063, 'max_drawdown': -2.590005000000019, 'sharpe': -0.45373724864683473, 'sortino': -0.5840749705008051}
>>> db.db_enabled(): True
[2026-01-26 04:02:46,030] [WARNING]: >>> db.db_enabled(): True
>>> Attempting to upsert metrics_daily: keys=['total_trades', 'net_pnl', 'win_rate', 'expectancy', 'profit_factor', 'max_drawdown', 'sharpe', 'sortino']
[2026-01-26 04:02:46,031] [WARNING]: >>> Upserting metrics_daily: keys=['total_trades', 'net_pnl', 'win_rate', 'expectancy', 'profit_factor', 'max_drawdown', 'sharpe', 'sortino']
[2026-01-26 04:02:46,045] [INFO]: [INFO] DB_WRITE_OK table=metrics_daily rows=1
>>> upsert_metrics_daily completed successfully
>>> METRICS COMPLETE <<<
>>> METRICS FILE COMPLETED <<<
[2026-01-26 04:02:46,058] [INFO]: >>> METRICS MAIN COMPLETED <<<
[2026-01-26 04:02:46,058] [INFO]:  [METRICS] main() complete
[2026-01-26 04:02:46,058] [INFO]: [INFO] metrics.py completed successfully
[2026-01-26T04:02:46.271954+00:00] END metrics rc=0 secs=1.6
